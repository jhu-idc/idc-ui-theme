!function(e){var t={};function s(n){if(t[n])return t[n].exports;var r=t[n]={i:n,l:!1,exports:{}};return e[n].call(r.exports,r,r.exports,s),r.l=!0,r.exports}s.m=e,s.c=t,s.d=function(e,t,n){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},s.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(s.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)s.d(n,r,function(t){return e[t]}.bind(null,r));return n},s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="/",s(s.s=1)}([function(e,t){},function(e,t,s){"use strict";s.r(t);const n=Symbol("Services");class r{constructor(e){this[n]=e}lookup({type:e,name:t}){return this[n][t]}}const i="undefined"!=typeof Symbol?Symbol:e=>`__${e}${Math.floor(Math.random()*Date.now())}__`;let a=1;const l=i("TAG_COMPUTE");function o(e){return a}function u(e,t){return t>=e[l]()}const c=i("TAG_TYPE");class h{constructor(e){this.revision=1,this.lastChecked=1,this.lastValue=1,this.isUpdating=!1,this.subtags=null,this.subtag=null,this.subtagBufferCache=null,this[c]=e}[l](){let{lastChecked:e}=this;if(!0===this.isUpdating)this.lastChecked=++a;else if(e!==a){this.isUpdating=!0,this.lastChecked=a;try{let{subtags:e,subtag:t,subtagBufferCache:s,lastValue:n,revision:r}=this;if(null!==t){let e=t[l]();e===s?r=Math.max(r,n):(this.subtagBufferCache=null,r=Math.max(r,e))}if(null!==e)for(let t=0;t<e.length;t++){let s=e[t][l]();r=Math.max(s,r)}this.lastValue=r}finally{this.isUpdating=!1}}return this.lastValue}static updateTag(e,t){let s=e,n=t;n===g?s.subtag=null:(s.subtagBufferCache=n[l](),s.subtag=n)}static dirtyTag(e){e.revision=++a}}const p=h.dirtyTag,d=h.updateTag;function m(){return new h(0)}function f(){return new h(1)}const g=new h(3);function b({tag:e}){return e===g}function y(e){return e===g}new class{[l](){return 9007199254740991}};new class{[l](){return a}};function v(e){let t=[];for(let s=0,n=e.length;s<n;s++){let n=e[s];n!==g&&t.push(n)}return w(t)}function w(e){switch(e.length){case 0:return g;case 1:return e[0];default:let t=new h(2);return t.subtags=e,t}}let k=function(){};function x(e){return"object"==typeof e&&null!==e||"function"==typeof e}const S=new WeakMap;function E(e,t){if(x(e)){let s=S.get(e);if(void 0===s)s=new Map,S.set(e,s);else if(s.has(t))return s.get(t);let n=f();return s.set(t,n),n}return g}class C{constructor(){this.tags=new Set,this.last=null}add(e){this.tags.add(e),this.last=e}combine(){let{tags:e}=this;if(0===e.size)return g;if(1===e.size)return this.last;{let t=[];return e.forEach(e=>t.push(e)),v(t)}}}let A=null;const N=[];function M(){N.push(A),A=new C}function _(){let e=A;return A=N.pop(),e.combine()}new WeakMap;function T(e,t){let s;M();try{e()}finally{s=_()}return s}function R(e){null!==A&&A.add(e)}function O(e){N.push(A),A=null;try{e()}finally{A=N.pop()}}const P=m();function L(e,t){let s=new WeakMap,n="function"==typeof t;return{getter:function(r){let i;return R(E(r,e)),n&&!s.has(r)?(i=t.call(r),s.set(r,i)):i=s.get(r),i},setter:function(t,n){p(P),function(e,t){if(!x(e))throw new Error("BUG: Can't update a tag for a primitive");{let s=S.get(e);if(void 0===s)return;let n=s.get(t);void 0!==n&&(p(n),k())}}(t,e),s.set(t,n)}}}const B=Object.freeze([]);var D=function(e,t){if(!e)throw new Error(t||"assertion failure")};let I=0;function z(e){return e._guid=++I}function U(){return Object.create(null)}function j(e){return"object"==typeof e&&null!==e}class H{constructor(){this.stack=[],this.current=null}get size(){return this.stack.length}push(e){this.current=e,this.stack.push(e)}pop(){let e=this.stack.pop(),t=this.stack.length;return this.current=0===t?null:this.stack[t-1],void 0===e?null:e}nth(e){let t=this.stack.length;return t<e?null:this.stack[t-e]}isEmpty(){return 0===this.stack.length}toArray(){return this.stack}}function F(e="unreachable"){return new Error(e)}function V(e){throw new Error("Exhausted "+e)}const $="undefined"!=typeof Symbol?Symbol:e=>`__${e}${Math.floor(Math.random()*Date.now())}__`,W=$("DESTROY");function J(e){let t=e.firstChild;for(;t;){let s=t.nextSibling;e.removeChild(t),t=s}}const G=new WeakMap,Y=$("WILL_DROP"),K=$("DID_DROP"),q=$("CHILDREN"),X=new WeakMap;function Z(e){return null!==e&&"object"==typeof e&&void 0!==e[K]}function Q(e,t){ee(e,ne(t))}function ee(e,t){let s=G.get(e);s||(s=new Set,G.set(e,s)),s.add(t)}function te(e){let t=G.get(e);t&&t.forEach(e=>{e[Y]()})}function se(e){let t=G.get(e);t&&t.forEach(e=>{e[K](),t.delete(e)})}function ne(e){let t=X.get(e);return t||(t=function(e){return!(!e||void 0===e[W])}(e)?new ae(e):function(e){return!(!e||"object"!=typeof e||"function"!=typeof e.destroy)}(e)?new le(e):new oe(e),X.set(e,t)),t}function re(e){return new ie(e)}class ie{constructor(e){this.destructors=e}[Y](){this.destructors.forEach(e=>e[Y]())}[K](){this.destructors.forEach(e=>e[K]())}get[q](){return this.destructors}toString(){return"SnapshotDestructor"}}class ae{constructor(e){this.inner=e}[Y](){te(this.inner)}[K](){this.inner[W](),se(this.inner)}get[q](){return G.get(this.inner)||[]}toString(){return"DestroyableDestructor"}}class le{constructor(e){this.inner=e}[Y](){"function"==typeof this.inner.willDestroy&&this.inner.willDestroy(),te(this.inner)}[K](){this.inner.destroy(),se(this.inner)}get[q](){return G.get(this.inner)||[]}toString(){return"StringDestroyableDestructor"}}class oe{constructor(e){this.inner=e}[Y](){te(this.inner)}[K](){se(this.inner)}get[q](){return G.get(this.inner)||[]}toString(){return"SimpleDestructor"}}class ue{constructor(){this.clear()}head(){return this._head}tail(){return this._tail}clear(){this._head=this._tail=null}toArray(){let e=[];return this.forEachNode(t=>e.push(t)),e}nextNode(e){return e.next}forEachNode(e){let t=this._head;for(;null!==t;)e(t),t=t.next}insertBefore(e,t=null){return null===t?this.append(e):(t.prev?t.prev.next=e:this._head=e,e.prev=t.prev,e.next=t,t.prev=e,e)}append(e){let t=this._tail;return t?(t.next=e,e.prev=t,e.next=null):this._head=e,this._tail=e}remove(e){return e.prev?e.prev.next=e.next:this._head=e.next,e.next?e.next.prev=e.prev:this._tail=e.prev,e}[Y](){this.forEachNode(e=>ne(e)[Y]())}[K](){this.forEachNode(e=>ne(e)[K]())}get[q](){let e=[];return this.forEachNode(t=>e.push(...ne(t)[q])),e}}class ce{constructor(e,t){this._head=e,this._tail=t}forEachNode(e){let t=this._head;for(;null!==t;)e(t),t=this.nextNode(t)}head(){return this._head}tail(){return this._tail}toArray(){let e=[];return this.forEachNode(t=>e.push(t)),e}nextNode(e){return e===this._tail?null:e.next}}new ce(null,null);const{keys:he}=Object;function pe(e){for(let t=1;t<arguments.length;t++){let s=arguments[t];if(null===s||"object"!=typeof s)continue;let n=he(s);for(let t=0;t<n.length;t++){let r=n[t];e[r]=s[r]}}return e}function de(e){return"number"==typeof e?e<0?1073741827-e:e:!1===e?1073741824:!0===e?1073741825:null===e?1073741826:void 0===e?1073741827:V(e)}function me(e){return function(e,t,s){return e%1==0&&e>=t&&e<=s}(e,-1073741820,1073741823)}function fe(e){return e<0}function ge(e,t=2147483647,s=-1){if(e>t)throw new Error(`index ${e} overflowed range 0 to ${t}`);return s-e}function be(e,t=-1){return t-e}function ye(e){if("number"==typeof e)return e;{let t=e.errors[0];throw new Error(`Compile Error: ${t.problem} @ ${t.span.start}..${t.span.end}`)}}function ve(e){if("error"===e.result)throw new Error(`Compile Error: ${e.problem} @ ${e.span.start}..${e.span.end}`);return e}function we(e,t="unexpected unreachable branch"){console.log("unreachable",e),console.trace(`${t} :: ${JSON.stringify(e)} (${e})`)}function ke(e){return e<=3}var xe,Se;!function(e){e[e.s0=4]="s0",e[e.s1=5]="s1"}(xe||(xe={})),function(e){e[e.t0=6]="t0",e[e.t1=7]="t1"}(Se||(Se={}));const Ee=$("INNER_VM"),Ce=$("DESTRUCTOR_STACK"),Ae=$("STACKS"),Ne=$("REGISTERS"),Me=$("HEAP"),_e=$("CONSTANTS"),Te=$("ARGS");$("PC");class Re{constructor(e,t){this.element=e,this.nextSibling=t}}class Oe{constructor(e,t,s){this.parentNode=e,this.first=t,this.last=s}parentElement(){return this.parentNode}firstNode(){return this.first}lastNode(){return this.last}}class Pe{constructor(e,t){this.parentNode=e,this.node=t}parentElement(){return this.parentNode}firstNode(){return this.node}lastNode(){return this.node}}function Le(e,t){let s=e.parentElement(),n=e.firstNode(),r=e.lastNode(),i=n;for(;;){let e=i.nextSibling;if(s.insertBefore(i,t),i===r)return e;i=e}}function Be(e){let t=e.parentElement(),s=e.firstNode(),n=e.lastNode(),r=s;for(;;){let e=r.nextSibling;if(t.removeChild(r),r===n)return e;r=e}}function De(e,t){let s=function(e){return G.get(e)||null}(e);null!==s&&t.willDestroy(re(s))}function Ie(e,t){let s=function(e){let t=G.get(e);return t&&t.size>0?(G.delete(e),t):null}(e);null!==s&&t.didDestroy(re(s))}function ze(e,t){t.willDestroy(ne(e))}function Ue(e,t){t.didDestroy(ne(e))}var je;class He{constructor(e){this.node=e}firstNode(){return this.node}}class Fe{constructor(e){this.node=e}lastNode(){return this.node}}const Ve=$("CURSOR_STACK");class $e{constructor(e,t,s){this.constructing=null,this.operations=null,this[je]=new H,this.modifierStack=new H,this.blockStack=new H,this.pushElement(t,s),this.env=e,this.dom=e.getAppendOperations(),this.updateOperations=e.getDOM()}static forInitialRender(e,t){return new this(e,t.element,t.nextSibling).initialize()}static resume(e,t){let s=new this(e,t.parentElement(),t.reset(e)).initialize();return s.pushLiveBlock(t),s}initialize(){return this.pushSimpleBlock(),this}debugBlocks(){return this.blockStack.toArray()}get element(){return this[Ve].current.element}get nextSibling(){return this[Ve].current.nextSibling}get hasBlocks(){return this.blockStack.size>0}block(){return this.blockStack.current}popElement(){this[Ve].pop(),this[Ve].current}pushSimpleBlock(){return this.pushLiveBlock(new We(this.element))}pushUpdatableBlock(){return this.pushLiveBlock(new Ge(this.element))}pushBlockList(e){return this.pushLiveBlock(new Ye(this.element,e))}pushLiveBlock(e,t=!1){let s=this.blockStack.current;return null!==s&&(t||s.didAppendBounds(e)),this.__openBlock(),this.blockStack.push(e),e}popBlock(){return this.block().finalize(this),this.__closeBlock(),this.blockStack.pop()}__openBlock(){}__closeBlock(){}openElement(e){let t=this.__openElement(e);return this.constructing=t,t}__openElement(e){return this.dom.createElement(e,this.element)}flushElement(e){let t=this.element,s=this.constructing;this.__flushElement(t,s),this.constructing=null,this.operations=null,this.pushModifiers(e),this.pushElement(s,null),this.didOpenElement(s)}__flushElement(e,t){this.dom.insertBefore(e,t,this.nextSibling)}closeElement(){return this.willCloseElement(),this.popElement(),this.popModifiers()}pushRemoteElement(e,t,s){return this.__pushRemoteElement(e,t,s)}__pushRemoteElement(e,t,s){if(this.pushElement(e,s),void 0===s)for(;e.lastChild;)e.removeChild(e.lastChild);let n=new Je(e);return this.pushLiveBlock(n,!0)}popRemoteElement(){this.popBlock(),this.popElement()}pushElement(e,t=null){this[Ve].push(new Re(e,t))}pushModifiers(e){this.modifierStack.push(e)}popModifiers(){return this.modifierStack.pop()}didAppendBounds(e){return this.block().didAppendBounds(e),e}didAppendNode(e){return this.block().didAppendNode(e),e}didOpenElement(e){return this.block().openElement(e),e}willCloseElement(){this.block().closeElement()}appendText(e){return this.didAppendNode(this.__appendText(e))}__appendText(e){let{dom:t,element:s,nextSibling:n}=this,r=t.createTextNode(e);return t.insertBefore(s,r,n),r}__appendNode(e){return this.dom.insertBefore(this.element,e,this.nextSibling),e}__appendFragment(e){let t=e.firstChild;if(t){let s=new Oe(this.element,t,e.lastChild);return this.dom.insertBefore(this.element,e,this.nextSibling),s}return new Pe(this.element,this.__appendComment(""))}__appendHTML(e){return this.dom.insertHTMLBefore(this.element,this.nextSibling,e)}appendDynamicHTML(e){let t=this.trustedContent(e);this.didAppendBounds(t)}appendDynamicText(e){let t=this.untrustedContent(e);return this.didAppendNode(t),t}appendDynamicFragment(e){let t=this.__appendFragment(e);this.didAppendBounds(t)}appendDynamicNode(e){let t=this.__appendNode(e),s=new Pe(this.element,t);this.didAppendBounds(s)}trustedContent(e){return this.__appendHTML(e)}untrustedContent(e){return this.__appendText(e)}appendComment(e){return this.didAppendNode(this.__appendComment(e))}__appendComment(e){let{dom:t,element:s,nextSibling:n}=this,r=t.createComment(e);return t.insertBefore(s,r,n),r}__setAttribute(e,t,s){this.dom.setAttribute(this.constructing,e,t,s)}__setProperty(e,t){this.constructing[e]=t}setStaticAttribute(e,t,s){this.__setAttribute(e,t,s)}setDynamicAttribute(e,t,s,n){let r=this.constructing,i=this.env.attributeFor(r,e,s,n);return i.set(this,t,this.env),i}}je=Ve;class We{constructor(e){this.parent=e,this.first=null,this.last=null,this.destroyables=null,this.nesting=0}parentElement(){return this.parent}firstNode(){return this.first.firstNode()}lastNode(){return this.last.lastNode()}openElement(e){this.didAppendNode(e),this.nesting++}closeElement(){this.nesting--}didAppendNode(e){0===this.nesting&&(this.first||(this.first=new He(e)),this.last=new Fe(e))}didAppendBounds(e){0===this.nesting&&(this.first||(this.first=e),this.last=e)}finalize(e){null===this.first&&e.appendComment("")}}class Je extends We{[W](){this.parentElement()===this.firstNode().parentNode&&Be(this)}}class Ge extends We{reset(e){let t=function(e,t){return De(e,t),Ie(e,t),Be(e)}(this,e);return this.first=null,this.last=null,this.destroyables=null,this.nesting=0,t}}class Ye{constructor(e,t){this.parent=e,this.boundList=t,this.parent=e,this.boundList=t}parentElement(){return this.parent}firstNode(){return this.boundList.head().firstNode()}lastNode(){return this.boundList.tail().lastNode()}openElement(e){}closeElement(){}didAppendNode(e){}didAppendBounds(e){}finalize(e){}}class Ke{constructor(e){this.lastValue=null,this.lastRevision=null,this.initialized=!1,this.tag=e.tag,this.reference=e}peek(){return this.initialized?this.lastValue:this.initialize()}revalidate(){if(!this.initialized)return this.initialize();let{reference:e,lastRevision:t}=this,s=e.tag;if(u(s,t))return qe;let{lastValue:n}=this,r=e.value();return this.lastRevision=o(),r===n?qe:(this.lastValue=r,r)}initialize(){let{reference:e}=this,t=this.lastValue=e.value();return this.lastRevision=o(e.tag),this.initialized=!0,t}}const qe=$("NOT_MODIFIED");const Xe=new class{constructor(e){this.inner=e,this.tag=g}value(){return this.inner}get(e){return Xe}}(void 0);class Ze{constructor(e){this.inner=e,this.tag=g}value(){return this.inner}get(e){return Xe}}class Qe extends class{constructor(e){this.next=null,this.prev=null,this.value=e}}{constructor(e,t){super(e.valueReferenceFor(t)),this.retained=!1,this.seen=!1,this.key=t.key,this.iterable=e,this.memo=e.memoReferenceFor(t)}update(e){this.retained=!0,this.iterable.updateValueReference(this.value,e),this.iterable.updateMemoReference(this.memo,e)}shouldRemove(){return!this.retained}reset(){this.retained=!1,this.seen=!1}}class et{constructor(e){this.iterator=null,this.map=new Map,this.list=new ue,this.tag=e.tag,this.iterable=e}isEmpty(){return(this.iterator=this.iterable.iterate()).isEmpty()}iterate(){let e;return e=null===this.iterator?this.iterable.iterate():this.iterator,this.iterator=null,e}advanceToKey(e,t){let s=t;for(;null!==s&&s.key!==e;)s=this.advanceNode(s);return s}has(e){return this.map.has(e)}get(e){return this.map.get(e)}wasSeen(e){let t=this.map.get(e);return void 0!==t&&t.seen}update(e){let t=this.get(e.key);return t.update(e),t}append(e){let{map:t,list:s,iterable:n}=this,r=new Qe(n,e);return t.set(e.key,r),s.append(r),r}insertBefore(e,t){let{map:s,list:n,iterable:r}=this,i=new Qe(r,e);return s.set(e.key,i),i.retained=!0,n.insertBefore(i,t),i}move(e,t){let{list:s}=this;e.retained=!0,s.remove(e),s.insertBefore(e,t)}remove(e){let{list:t}=this;t.remove(e),this.map.delete(e.key)}nextNode(e){return this.list.nextNode(e)}advanceNode(e){return e.seen=!0,this.list.nextNode(e)}head(){return this.list.head()}}class tt{constructor(e){this.iterator=null;let t=new et(e);this.artifacts=t}next(){let{artifacts:e}=this,t=(this.iterator=this.iterator||e.iterate()).next();return null===t?null:e.append(t)}}var st;!function(e){e[e.Append=0]="Append",e[e.Prune=1]="Prune",e[e.Done=2]="Done"}(st||(st={}));const nt=$("END");class rt{constructor({target:e,artifacts:t,env:s}){this.target=e,this.artifacts=t,this.iterator=t.iterate(),this.current=t.head(),this.env=s}sync(){let e=st.Append;for(;;)switch(e){case st.Append:e=this.nextAppend();break;case st.Prune:e=this.nextPrune();break;case st.Done:return void this.nextDone()}}advanceToKey(e){let{current:t,artifacts:s}=this;if(null===t)return;let n=s.advanceNode(t);if(n.key===e)return void(this.current=s.advanceNode(n));let r=s.advanceToKey(e,t);r&&(this.move(r,t),this.current=s.nextNode(t))}move(e,t){e.next!==t&&(this.artifacts.move(e,t),this.target.move(this.env,e.key,e.value,e.memo,t?t.key:nt))}nextAppend(){let{iterator:e,current:t,artifacts:s}=this,n=e.next();if(null===n)return this.startPrune();let{key:r}=n;return null!==t&&t.key===r?this.nextRetain(n,t):s.has(r)?this.nextMove(n):this.nextInsert(n),st.Append}nextRetain(e,t){let{artifacts:s}=this;t.update(e),this.current=s.nextNode(t),this.target.retain(this.env,e.key,t.value,t.memo)}nextMove(e){let{current:t,artifacts:s}=this,{key:n}=e,r=s.update(e);s.wasSeen(n)?this.move(r,t):this.advanceToKey(n)}nextInsert(e){let{artifacts:t,target:s,current:n}=this,r=t.insertBefore(e,n);s.insert(this.env,r.key,r.value,r.memo,n?n.key:null)}startPrune(){return this.current=this.artifacts.head(),st.Prune}nextPrune(){let{artifacts:e,target:t,current:s}=this;if(null===s)return st.Done;let n=s;return this.current=e.nextNode(n),n.shouldRemove()?(e.remove(n),t.delete(this.env,n.key)):n.reset(),st.Prune}nextDone(){this.target.done(this.env)}}const it=$("UPDATE_REFERENCED_VALUE");class at{constructor(e){this.env=e,this.children=U(),this.tag=g}get(e){{let t=this.children[e];return void 0===t&&(t=this.children[e]=new ut(this,e,this.env)),t}}}class lt extends at{constructor(e,t){super(t),this.inner=e}value(){return this.inner}}class ot extends at{constructor(e,t,s,n){super(s),this.fn=e,this.args=t,this.computeRevision=null,this.computeTag=null,b(t)&&this.compute();let{tag:r,computeTag:i}=this;if(null!==i&&y(i))r=this.tag=g,this.computeRevision=o();else{let e=this.valueTag=f();r=this.tag=v([t.tag,e]),null!==i&&(d(e,i),this.computeRevision=o())}}compute(){this.computeTag=T(()=>{this.computeValue=this.fn(this.args)})}value(){let{tag:e,computeRevision:t}=this;return null!==t&&u(e,t)||(this.compute(),d(this.valueTag,this.computeTag),this.computeRevision=o()),this.computeValue}}class ut{constructor(e,t,s){this.parentReference=e,this.propertyKey=t,this.env=s,this.children=U(),this.lastRevision=null;let n=this.valueTag=f(),r=e.tag;this.tag=v([r,n])}value(){let{tag:e,lastRevision:t,lastValue:s,parentReference:n,valueTag:r,propertyKey:i}=this;if(null===t||!u(e,t)){let e=n.value();if(null!=e){let t=T(()=>{s=this.env.getPath(e,i)});d(r,t)}else s=void 0;this.lastValue=s,this.lastRevision=o()}return s}get(e){{let t=this.children[e];return void 0===t&&(t=this.children[e]=new ut(this,e,this.env)),t}}[it](e){let{parentReference:t,propertyKey:s}=this,n=t.value();this.env.setPath(n,s,e)}}class ct{constructor(e,t,s,n){this.parentReference=e,this.itemValue=t,this.env=n,this.tag=f(),this.children=U()}value(){return this.itemValue}update(e){p(this.tag),this.itemValue=e}get(e){{let t=this.children[e];return void 0===t&&(t=this.children[e]=new ut(this,e,this.env)),t}}}const ht={},pt=(e,t)=>t,dt=(e,t)=>String(t),mt=e=>null===e?ht:e;function ft(e,t){switch(e){case"@key":return yt(pt);case"@index":return yt(dt);case"@identity":return yt(mt);default:return function(e,t){return yt(s=>t(s,e))}(e,t)}}class gt{get weakMap(){return void 0===this._weakMap&&(this._weakMap=new WeakMap),this._weakMap}get primitiveMap(){return void 0===this._primitiveMap&&(this._primitiveMap=new Map),this._primitiveMap}set(e,t){j(e)||"function"==typeof e?this.weakMap.set(e,t):this.primitiveMap.set(e,t)}get(e){return j(e)||"function"==typeof e?this.weakMap.get(e):this.primitiveMap.get(e)}}const bt=new gt;function yt(e){let t=new gt;return(s,n)=>{let r=e(s,n),i=t.get(s)||0;return t.set(r,i+1),0===i?r:function(e,t){let s=bt.get(e);void 0===s&&(s=[],bt.set(e,s));let n=s[t];return void 0===n&&(n={value:e,count:t},s[t]=n),n}(r,i)}}class vt{constructor(e,t,s){this.parentRef=e,this.key=t,this.env=s,this.tag=e.tag}iterate(){let{parentRef:e,key:t,env:s}=this,n=e.value(),r=ft(t,s.getPath);if(Array.isArray(n))return new kt(n,r);let i=s.toIterator(n);return null===i?new kt(B,()=>null):new wt(i,r)}valueReferenceFor(e){let{parentRef:t,env:s}=this;return new ct(t,e.value,e.memo,s)}updateValueReference(e,t){e.update(t.value)}memoReferenceFor(e){let{parentRef:t,env:s}=this;return new ct(t,e.memo,"",s)}updateMemoReference(e,t){e.update(t.memo)}}class wt{constructor(e,t){this.inner=e,this.keyFor=t}isEmpty(){return this.inner.isEmpty()}next(){let e=this.inner.next();return null!==e&&(e.key=this.keyFor(e.value,e.memo)),e}}class kt{constructor(e,t){this.iterator=e,this.keyFor=t,this.pos=0,0===e.length?this.current={kind:"empty"}:this.current={kind:"first",value:e[this.pos]}}isEmpty(){return"empty"===this.current.kind}next(){let e,t=this.current;if("first"===t.kind)this.current={kind:"progress"},e=t.value;else{if(this.pos>=this.iterator.length-1)return null;e=this.iterator[++this.pos]}let{keyFor:s}=this;return{key:s(e,this.pos),value:e,memo:this.pos}}}const xt={foreignObject:1,desc:1,title:1},St=Object.create(null);class Et{constructor(e){this.document=e,this.setupUselessElement()}setupUselessElement(){this.uselessElement=this.document.createElement("div")}createElement(e,t){let s,n;if(t?(s="http://www.w3.org/2000/svg"===t.namespaceURI||"svg"===e,n=!!xt[t.tagName]):(s="svg"===e,n=!1),s&&!n){if(St[e])throw new Error(`Cannot create a ${e} inside an SVG context`);return this.document.createElementNS("http://www.w3.org/2000/svg",e)}return this.document.createElement(e)}insertBefore(e,t,s){e.insertBefore(t,s)}insertHTMLBefore(e,t,s){if(""===s){let s=this.createComment("");return e.insertBefore(s,t),new Oe(e,s,s)}let n,r=t?t.previousSibling:e.lastChild;if(null===t)e.insertAdjacentHTML("beforeend",s),n=e.lastChild;else if(t instanceof HTMLElement)t.insertAdjacentHTML("beforebegin",s),n=t.previousSibling;else{let{uselessElement:r}=this;e.insertBefore(r,t),r.insertAdjacentHTML("beforebegin",s),n=r.previousSibling,e.removeChild(r)}let i=r?r.nextSibling:e.firstChild;return new Oe(e,i,n)}createTextNode(e){return this.document.createTextNode(e)}createComment(e){return this.document.createComment(e)}}function Ct(e,t,s){if(!e)return t;if(!function(e,t){let s=e.createElementNS(t,"svg");try{s.insertAdjacentHTML("beforeend","<circle></circle>")}catch(e){}finally{return 1!==s.childNodes.length||"http://www.w3.org/2000/svg"!==s.firstChild.namespaceURI}}(e,s))return t;let n=e.createElement("div");return class extends t{insertHTMLBefore(e,t,r){return""===r||e.namespaceURI!==s?super.insertHTMLBefore(e,t,r):function(e,t,s,n){let r;if("FOREIGNOBJECT"===e.tagName.toUpperCase()){let e="<svg><foreignObject>"+s+"</foreignObject></svg>";J(t),t.insertAdjacentHTML("afterbegin",e),r=t.firstChild.firstChild}else{let e="<svg>"+s+"</svg>";J(t),t.insertAdjacentHTML("afterbegin",e),r=t.firstChild}return function(e,t,s){let n=e.firstChild,r=n,i=n;for(;i;){let e=i.nextSibling;t.insertBefore(i,s),r=i,i=e}return new Oe(t,n,r)}(r,e,n)}(e,n,r,t)}}}function At(e,t){return e&&function(e){let t=e.createElement("div");if(t.appendChild(e.createTextNode("first")),t.insertAdjacentHTML("beforeend","second"),2===t.childNodes.length)return!1;return!0}(e)?class extends t{constructor(e){super(e),this.uselessComment=e.createComment("")}insertHTMLBefore(e,t,s){if(""===s)return super.insertHTMLBefore(e,t,s);let n=!1,r=t?t.previousSibling:e.lastChild;r&&r instanceof Text&&(n=!0,e.insertBefore(this.uselessComment,t));let i=super.insertHTMLBefore(e,t,s);return n&&e.removeChild(this.uselessComment),i}}:t}["b","big","blockquote","body","br","center","code","dd","div","dl","dt","em","embed","h1","h2","h3","h4","h5","h6","head","hr","i","img","li","listing","main","meta","nobr","ol","p","pre","ruby","s","small","span","strong","strike","sub","sup","table","tt","u","ul","var"].forEach(e=>St[e]=1);let Nt="undefined"==typeof document?null:document;var Mt;!function(e){class t extends Et{createElementNS(e,t){return this.document.createElementNS(e,t)}setAttribute(e,t,s,n=null){n?e.setAttributeNS(n,t,s):e.setAttribute(t,s)}}e.TreeConstruction=t;let s=t;s=At(Nt,s),s=Ct(Nt,s,"http://www.w3.org/2000/svg"),e.DOMTreeConstruction=s}(Mt||(Mt={}));class _t extends Et{constructor(e){super(e),this.document=e,this.namespace=null}setAttribute(e,t,s){e.setAttribute(t,s)}removeAttribute(e,t){e.removeAttribute(t)}insertAfter(e,t,s){this.insertBefore(e,t,s.nextSibling)}}let Tt=_t;Tt=At(Nt,Tt),Tt=Ct(Nt,Tt,"http://www.w3.org/2000/svg");const Rt=Mt.DOMTreeConstruction;class Ot extends Ze{static create(e){return void 0===e?Bt:null===e?Dt:!0===e?It:!1===e?zt:"number"==typeof e?new Lt(e):new Pt(e)}constructor(e){super(e)}get(e){return Bt}}class Pt extends Ot{constructor(){super(...arguments),this.lengthReference=null}get(e){if("length"===e){let{lengthReference:e}=this;return null===e&&(e=this.lengthReference=new Lt(this.inner.length)),e}return super.get(e)}}class Lt extends Ot{constructor(e){super(e)}}const Bt=new Lt(void 0),Dt=new Lt(null),It=new Lt(!0),zt=new Lt(!1);class Ut{constructor(e,t=jt){this.inner=e,this.toBool=t,this.tag=e.tag}value(){return this.toBool(this.inner.value())}}function jt(e){return!!e}function Ht(e){return Ft(e)?"":String(e)}function Ft(e){return null==e||"function"!=typeof e.toString}function Vt(e){return"object"==typeof e&&null!==e&&"function"==typeof e.toHTML}function $t(e){return"object"==typeof e&&null!==e&&"number"==typeof e.nodeType}function Wt(e){return"string"==typeof e}function Jt(e,t){let s,n;if(t in e)n=t,s="prop";else{let r=t.toLowerCase();r in e?(s="prop",n=r):(s="attr",n=t)}return"prop"!==s||"style"!==n.toLowerCase()&&!function(e,t){let s=Gt[e.toUpperCase()];return s&&s[t.toLowerCase()]||!1}(e.tagName,n)||(s="attr"),{normalized:n,type:s}}const Gt={INPUT:{form:!0,autocorrect:!0,list:!0},SELECT:{form:!0},OPTION:{form:!0},TEXTAREA:{form:!0},LABEL:{form:!0},FIELDSET:{form:!0},LEGEND:{form:!0},OBJECT:{form:!0},BUTTON:{form:!0}};const Yt=["javascript:","vbscript:"],Kt=["A","BODY","LINK","IMG","IFRAME","BASE","FORM"],qt=["EMBED"],Xt=["href","src","background","action"],Zt=["src"];function Qt(e,t){return-1!==e.indexOf(t)}function es(e,t){return(null===e||Qt(Kt,e))&&Qt(Xt,t)}function ts(e,t){return null!==e&&(Qt(qt,e)&&Qt(Zt,t))}function ss(e,t){return es(e,t)||ts(e,t)}function ns(e,t,s,n){let r=null;if(null==n)return n;if(Vt(n))return n.toHTML();r=t?t.tagName.toUpperCase():null;let i=Ht(n);if(es(r,s)){let t=e.protocolForURL(i);if(Qt(Yt,t))return"unsafe:"+i}return ts(r,s)?"unsafe:"+i:i}function rs(e,t,s){let{tagName:n,namespaceURI:r}=e,i={element:e,name:t,namespace:s};if("http://www.w3.org/2000/svg"===r)return is(n,t,i);let{type:a,normalized:l}=Jt(e,t);return"attr"===a?is(n,l,i):function(e,t,s){if(ss(e,t))return new us(t,s);if(function(e,t){return("INPUT"===e||"TEXTAREA"===e)&&"value"===t}(e,t))return new hs(t,s);if(function(e,t){return"OPTION"===e&&"selected"===t}(e,t))return new ps(t,s);return new os(t,s)}(n,l,i)}function is(e,t,s){return ss(e,t)?new cs(s):new ls(s)}class as{constructor(e){this.attribute=e}}class ls extends as{set(e,t,s){let n=ds(t);if(null!==n){let{name:t,namespace:s}=this.attribute;e.__setAttribute(t,n,s)}}update(e,t){let s=ds(e),{element:n,name:r}=this.attribute;null===s?n.removeAttribute(r):n.setAttribute(r,s)}}class os extends as{constructor(e,t){super(t),this.normalizedName=e}set(e,t,s){null!=t&&(this.value=t,e.__setProperty(this.normalizedName,t))}update(e,t){let{element:s}=this.attribute;this.value!==e&&(s[this.normalizedName]=this.value=e,null==e&&this.removeAttribute())}removeAttribute(){let{element:e,namespace:t}=this.attribute;t?e.removeAttributeNS(t,this.normalizedName):e.removeAttribute(this.normalizedName)}}class us extends os{set(e,t,s){let{element:n,name:r}=this.attribute,i=ns(s,n,r,t);super.set(e,i,s)}update(e,t){let{element:s,name:n}=this.attribute,r=ns(t,s,n,e);super.update(r,t)}}class cs extends ls{set(e,t,s){let{element:n,name:r}=this.attribute,i=ns(s,n,r,t);super.set(e,i,s)}update(e,t){let{element:s,name:n}=this.attribute,r=ns(t,s,n,e);super.update(r,t)}}class hs extends os{set(e,t){e.__setProperty("value",Ht(t))}update(e){let t=this.attribute.element,s=t.value,n=Ht(e);s!==n&&(t.value=n)}}class ps extends os{set(e,t){null!=t&&!1!==t&&e.__setProperty("selected",!0)}update(e){let t=this.attribute.element;t.selected=!!e}}function ds(e){return!1===e||null==e||void 0===e.toString?null:!0===e?"":"function"==typeof e?null:String(e)}const ms={},fs=Object.freeze([]);class gs{constructor(){this.strings=[],this.arrays=[fs],this.tables=[],this.handles=[],this.resolved=[],this.numbers=[],this.others=[]}other(e){return this.others.push(e)-1}string(e){let t=this.strings.indexOf(e);return t>-1?t:this.strings.push(e)-1}stringArray(e){let t=new Array(e.length);for(let s=0;s<e.length;s++)t[s]=this.string(e[s]);return this.array(t)}array(e){if(0===e.length)return 0;let t=this.arrays.indexOf(e);return t>-1?t:this.arrays.push(e)-1}serializable(e){let t=JSON.stringify(e),s=this.strings.indexOf(t);return s>-1?s:this.strings.push(t)-1}templateMeta(e){return this.serializable(e)}number(e){let t=this.numbers.indexOf(e);return t>-1?t:this.numbers.push(e)-1}toPool(){return{strings:this.strings,arrays:this.arrays,handles:this.handles,numbers:this.numbers}}}class bs{constructor(e){this.strings=e.strings,this.arrays=e.arrays,this.handles=e.handles,this.numbers=e.numbers,this.others=[]}getString(e){return this.strings[e]}getNumber(e){return this.numbers[e]}getStringArray(e){let t=this.getArray(e),s=new Array(t.length);for(let e=0;e<t.length;e++){let n=t[e];s[e]=this.getString(n)}return s}getArray(e){return this.arrays[e]}getSerializable(e){return JSON.parse(this.strings[e])}getTemplateMeta(e){return this.getSerializable(e)}getOther(e){return this.others[e]}}class ys extends gs{constructor(e){super(),this.metas=[],e&&(this.strings=e.strings,this.arrays=e.arrays,this.handles=e.handles,this.resolved=this.handles.map(()=>ms),this.numbers=e.numbers),this.others=[]}templateMeta(e){let t=this.metas.indexOf(e);return t>-1?t:this.metas.push(e)-1}getNumber(e){return this.numbers[e]}getString(e){return this.strings[e]}getStringArray(e){let t=this.getArray(e),s=new Array(t.length);for(let e=0;e<t.length;e++){let n=t[e];s[e]=this.getString(n)}return s}getArray(e){return this.arrays[e]}getSerializable(e){return JSON.parse(this.strings[e])}getTemplateMeta(e){return this.metas[e]}getOther(e){return this.others[e]}}class vs{constructor(e){this.heap=e,this.offset=0}get size(){return 1+((768&this.heap.getbyaddr(this.offset))>>8)}get isMachine(){return 1024&this.heap.getbyaddr(this.offset)?1:0}get type(){return 255&this.heap.getbyaddr(this.offset)}get op1(){return this.heap.getbyaddr(this.offset+1)}get op2(){return this.heap.getbyaddr(this.offset+2)}get op3(){return this.heap.getbyaddr(this.offset+3)}}function ws(e,t){return t|e<<2}function ks(e,t){return e|t<<30}class xs{constructor(e){let{buffer:t,table:s}=e;this.heap=new Int32Array(t),this.table=s}getaddr(e){return this.table[e]}getbyaddr(e){return this.heap[e]}sizeof(e){return As(this.table,e)}scopesizeof(e){return Ns(this.table,e)}}class Ss{constructor(){this.placeholders=[],this.stdlibs=[],this.offset=0,this.handle=0,this.capacity=1048576,this.heap=new Int32Array(1048576),this.table=[]}push(e){this.sizeCheck(),this.heap[this.offset++]=e}sizeCheck(){if(0===this.capacity){let e=Cs(this.heap,0,this.offset);this.heap=new Int32Array(e.length+1048576),this.heap.set(e,0),this.capacity=1048576}this.capacity--}getbyaddr(e){return this.heap[e]}setbyaddr(e,t){this.heap[e]=t}malloc(){this.table.push(this.offset,0,0);let e=this.handle;return this.handle+=3,e}finishMalloc(e,t){this.table[e+1]=ws(t,0)}size(){return this.offset}getaddr(e){return this.table[e]}gethandle(e){this.table.push(e,ws(0,3),0);let t=this.handle;return this.handle+=3,t}sizeof(e){return As(this.table,e)}scopesizeof(e){return Ns(this.table,e)}free(e){let t=this.table[e+1];this.table[e+1]=ks(t,1)}compact(){let e=0,{table:t,table:{length:s},heap:n}=this;for(let r=0;r<s;r+=3){let s=t[r],i=t[r+1],a=i&Size.SIZE_MASK,l=0&i;if(2!==l)if(1===l)t[r+1]=ks(i,2),e+=a;else if(0===l){for(let t=s;t<=r+a;t++)n[t-e]=n[t];t[r]=s-e}else 3===l&&(t[r]=s-e)}this.offset=this.offset-e}pushPlaceholder(e){this.sizeCheck();let t=this.offset++;this.heap[t]=2147483647,this.placeholders.push([t,e])}pushStdlib(e){this.sizeCheck();let t=this.offset++;this.heap[t]=2147483647,this.stdlibs.push([t,e])}patchPlaceholders(){let{placeholders:e}=this;for(let t=0;t<e.length;t++){let[s,n]=e[t];this.setbyaddr(s,n())}}patchStdlibs(e){let{stdlibs:t}=this;for(let s=0;s<t.length;s++){let[n,{value:r}]=t[s];this.setbyaddr(n,e[r])}this.stdlibs=[]}capture(e,t=this.offset){this.patchPlaceholders(),this.patchStdlibs(e);let s=Cs(this.heap,0,t).buffer;return{handle:this.handle,table:this.table,buffer:s}}}class Es{constructor(e,t){this.constants=e,this.heap=t,this._opcode=new vs(this.heap)}static hydrate(e){let t=new xs(e.heap),s=new bs(e.constants);return new Es(s,t)}opcode(e){return this._opcode.offset=e,this._opcode}}function Cs(e,t,s){if(void 0!==e.slice)return e.slice(t,s);let n=new Int32Array(s);for(;t<s;t++)n[t]=e[t];return n}function As(e,t){return-1}function Ns(e,t){return e[t+1]>>2}function Ms(e){e.heap.patchStdlibs(e.stdlib)}var _s;class Ts{constructor(e,t,s,n){this.slots=e,this.callerScope=t,this.evalScope=s,this.partialMap=n}static root(e,t=0){let s=new Array(t+1);for(let e=0;e<=t;e++)s[e]=Bt;return new Ts(s,null,null,null).init({self:e})}static sized(e=0){let t=new Array(e+1);for(let s=0;s<=e;s++)t[s]=Bt;return new Ts(t,null,null,null)}init({self:e}){return this.slots[0]=e,this}getSelf(){return this.get(0)}getSymbol(e){return this.get(e)}getBlock(e){let t=this.get(e);return t===Bt?null:t}getEvalScope(){return this.evalScope}getPartialMap(){return this.partialMap}bind(e,t){this.set(e,t)}bindSelf(e){this.set(0,e)}bindSymbol(e,t){this.set(e,t)}bindBlock(e,t){this.set(e,t)}bindEvalScope(e){this.evalScope=e}bindPartialMap(e){this.partialMap=e}bindCallerScope(e){this.callerScope=e}getCallerScope(){return this.callerScope}child(){return new Ts(this.slots.slice(),this.callerScope,this.evalScope,this.partialMap)}get(e){if(e>=this.slots.length)throw new RangeError(`BUG: cannot get $${e} from scope; length=${this.slots.length}`);return this.slots[e]}set(e,t){if(e>=this.slots.length)throw new RangeError(`BUG: cannot get $${e} from scope; length=${this.slots.length}`);this.slots[e]=t}}const Rs=$("TRANSACTION");class Os{constructor(){this.scheduledInstallManagers=[],this.scheduledInstallModifiers=[],this.scheduledUpdateModifierManagers=[],this.scheduledUpdateModifiers=[],this.createdComponents=[],this.createdManagers=[],this.updatedComponents=[],this.updatedManagers=[],this.destructors=[]}didCreate(e,t){this.createdComponents.push(e),this.createdManagers.push(t)}didUpdate(e,t){this.updatedComponents.push(e),this.updatedManagers.push(t)}scheduleInstallModifier(e,t){this.scheduledInstallModifiers.push(e),this.scheduledInstallManagers.push(t)}scheduleUpdateModifier(e,t){this.scheduledUpdateModifiers.push(e),this.scheduledUpdateModifierManagers.push(t)}willDestroy(e){e[Y]()}didDestroy(e){this.destructors.push(e)}commit(){let{createdComponents:e,createdManagers:t}=this;for(let s=0;s<e.length;s++){let n=e[s];t[s].didCreate(n)}let{updatedComponents:s,updatedManagers:n}=this;for(let e=0;e<s.length;e++){let t=s[e];n[e].didUpdate(t)}let{destructors:r}=this;for(let e=0;e<r.length;e++)r[e][K]();let{scheduledInstallManagers:i,scheduledInstallModifiers:a}=this;for(let e=0;e<i.length;e++){let t=a[e];i[e].install(t)}let{scheduledUpdateModifierManagers:l,scheduledUpdateModifiers:o}=this;for(let e=0;e<l.length;e++){let t=o[e];l[e].update(t)}}}function Ps(e,t){let s=void 0!==e?e:t;return s}class Ls{constructor(e,t){this.delegate=t,this[_s]=null,this.extra=this.delegate.extra,this.isInteractive="boolean"!=typeof this.delegate.isInteractive||this.delegate.isInteractive,this.protocolForURL=Ps(this.delegate.protocolForURL,Bs),this.attributeFor=Ps(this.delegate.attributeFor,Ds),this.getPath=Ps(this.delegate.getPath,Is),this.setPath=Ps(this.delegate.setPath,zs),this.toBool=Ps(this.delegate.toBool,Us),this.toIterator=Ps(this.delegate.toIterator,js),e.appendOperations?(this.appendOperations=e.appendOperations,this.updateOperations=e.updateOperations):e.document&&(this.appendOperations=new Rt(e.document),this.updateOperations=new _t(e.document))}getTemplatePathDebugContext(e){return void 0!==this.delegate.getTemplatePathDebugContext?this.delegate.getTemplatePathDebugContext(e):""}setTemplatePathDebugContext(e,t,s){void 0!==this.delegate.setTemplatePathDebugContext&&this.delegate.setTemplatePathDebugContext(e,t,s)}iterableFor(e,t){let s=null===t?"@identity":String(t);return new vt(e,s,this)}toConditionalReference(e){return new Ut(e,this.delegate.toBool)}getAppendOperations(){return this.appendOperations}getDOM(){return this.updateOperations}begin(){void 0!==this.delegate.onTransactionBegin&&this.delegate.onTransactionBegin(),this[Rs]=new Os}get transaction(){return this[Rs]}didCreate(e,t){this.transaction.didCreate(e,t)}didUpdate(e,t){this.transaction.didUpdate(e,t)}scheduleInstallModifier(e,t){this.isInteractive&&this.transaction.scheduleInstallModifier(e,t)}scheduleUpdateModifier(e,t){this.isInteractive&&this.transaction.scheduleUpdateModifier(e,t)}willDestroy(e){this.transaction.willDestroy(e)}didDestroy(e){this.transaction.didDestroy(e)}commit(){let e=this.transaction;this[Rs]=null,e.commit(),void 0!==this.delegate.onTransactionCommit&&this.delegate.onTransactionCommit()}}function Bs(e){return"object"==typeof URL||"undefined"==typeof URL?function(e){if("undefined"==typeof window){let t=/^([a-z][a-z0-9.+-]*:)?(\/\/)?([\S\s]*)/i.exec(e);return t&&t[1]?t[1].toLowerCase():""}let t=window.document.createElement("a");return t.href=e,t.protocol}(e):"undefined"!=typeof document?new URL(e,document.baseURI).protocol:new URL(e,"https://www.example.com").protocol}function Ds(e,t,s,n){return rs(e,t,n)}function Is(e,t){return e[t]}function zs(e,t,s){return e[t]=s}function Us(e){return Boolean(e)}function js(e){return e&&e[Symbol.iterator]?e[Symbol.iterator]():null}_s=Rs;class Hs{constructor(e){this.inner=e}lookupComponent(e,t){if(this.inner.lookupComponent){let s=this.inner.lookupComponent(e,t);if(void 0===s)throw new Error(`Unexpected component ${e} (from ${t}) (lookupComponent returned undefined)`);return s}throw new Error("lookupComponent not implemented on RuntimeResolver.")}lookupPartial(e,t){if(this.inner.lookupPartial){let s=this.inner.lookupPartial(e,t);if(void 0===s)throw new Error(`Unexpected partial ${e} (from ${t}) (lookupPartial returned undefined)`);return s}throw new Error("lookupPartial not implemented on RuntimeResolver.")}resolve(e){if(this.inner.resolve){let t=this.inner.resolve(e);if(void 0===t)throw new Error(`Unexpected handle ${e} (resolve returned undefined)`);return t}throw new Error("resolve not implemented on RuntimeResolver.")}compilable(e){if(this.inner.compilable){let t=this.inner.compilable(e);if(void 0===t)throw new Error(`Unable to compile ${name} (compilable returned undefined)`);return t}throw new Error("compilable not implemented on RuntimeResolver.")}getInvocation(e){if(this.inner.getInvocation){let t=this.inner.getInvocation(e);if(void 0===t)throw new Error(`Unable to get invocation for ${JSON.stringify(e)} (getInvocation returned undefined)`);return t}throw new Error("getInvocation not implemented on RuntimeResolver.")}}const Fs=new class{constructor(){this.evaluateOpcode=function(e){let t=new Array(e);for(let s=0;s<e;s++)t[s]=null;return t}(107).slice()}add(e,t,s="syscall"){this.evaluateOpcode[e]={syscall:"machine"!==s,evaluate:t}}debugBefore(e,t){return{sp:void 0,pc:e.fetchValue(0),name:void 0,params:void 0,type:t.type,isMachine:t.isMachine,size:t.size,state:void 0}}debugAfter(e,t){let{sp:s,type:n,isMachine:r,pc:i}=t}evaluate(e,t,s){let n=this.evaluateOpcode[s];n.syscall?n.evaluate(e,t):n.evaluate(e[Ee],t)}};class Vs extends class{constructor(){z(this)}}{constructor(){super(...arguments),this.next=null,this.prev=null}}function $s(e){let t=[];for(let s=0,n=e.length;s<n;s++){let n=e[s].tag;n!==g&&t.push(n)}return w(t)}function Ws(e){let t=[],s=e.head();for(;null!==s;){let n=s.tag;n!==g&&t.push(n),s=e.nextNode(s)}return w(t)}class Js extends class{constructor(){this.lastRevision=null,this.lastValue=null}value(){let{tag:e,lastRevision:t,lastValue:s}=this;return null!==t&&u(e,t)||(s=this.lastValue=this.compute(),this.lastRevision=o()),s}invalidate(){this.lastRevision=null}}{constructor(e){super(),this.parts=e,this.tag=$s(e)}compute(){let e=new Array;for(let t=0;t<this.parts.length;t++){let s=this.parts[t].value();null!=s&&(e[t]=Gs(s))}return e.length>0?e.join(""):null}}function Gs(e){return"function"!=typeof e.toString?"":String(e)}function Ys(e){return e===Bt}function Ks(e){return 0|(e.dynamicLayout?1:0)|(e.dynamicTag?2:0)|(e.prepareArgs?4:0)|(e.createArgs?8:0)|(e.attributeHook?16:0)|(e.elementHook?32:0)|(e.dynamicScope?64:0)|(e.createCaller?128:0)|(e.updateHook?256:0)|(e.createInstance?512:0)|(e.wrapped?1024:0)|(e.willDestroy?2048:0)}function qs(e,t,s){return!!(t&s)}function Xs(e,t){return!!(e&t)}var Zs;Fs.add(16,(e,{op1:t})=>{let s=e.stack,n=e.runtime.resolver.resolve(t)(s.pop(),e);e.loadValue(8,n)}),Fs.add(22,(e,{op1:t})=>{let s=e.referenceForSymbol(t);e.stack.push(s)}),Fs.add(19,(e,{op1:t})=>{let s=e.stack.pop();e.scope().bindSymbol(t,s)}),Fs.add(21,(e,{op1:t})=>{let s=e.stack.pop(),n=e.stack.pop(),r=e.stack.pop(),i=r?[s,n,r]:null;e.scope().bindBlock(t,i)},"jit"),Fs.add(20,(e,{op1:t})=>{let s=e.stack.pop(),n=e.stack.pop(),r=e.stack.pop(),i=r?[s,n,r]:null;e.scope().bindBlock(t,i)}),Fs.add(105,(e,{op1:t})=>{let s=e[_e].getString(t),n=e.scope().getPartialMap()[s];void 0===n&&(n=e.getSelf().get(s)),e.stack.push(n)}),Fs.add(37,(e,{op1:t})=>{e.pushRootScope(t)}),Fs.add(23,(e,{op1:t})=>{let s=e[_e].getString(t),n=e.stack.pop();e.stack.push(n.get(s))}),Fs.add(24,(e,{op1:t})=>{let{stack:s}=e,n=e.scope().getBlock(t);s.push(n)}),Fs.add(25,e=>{let{stack:t}=e,s=t.pop();s&&!Ys(s)?(t.push(s[2]),t.push(s[1]),t.push(s[0])):(t.push(null),t.push(null),t.push(null))}),Fs.add(26,e=>{let{stack:t}=e,s=t.pop();s&&!Ys(s)?t.push(It):t.push(zt)}),Fs.add(27,e=>{e.stack.pop(),e.stack.pop();let t=e.stack.pop(),s=t&&t.parameters.length;e.stack.push(s?It:zt)}),Fs.add(28,(e,{op1:t})=>{let s=new Array(t);for(let n=t;n>0;n--){s[n-1]=e.stack.pop()}e.stack.push(new Js(s))});const Qs=$("CURRIED COMPONENT DEFINITION");function en(e){return!(!e||!e[Qs])}class tn{constructor(e,t){this.inner=e,this.args=t,this[Zs]=!0}unwrap(e){e.realloc(this.offset);let t=this;for(;;){let{args:s,inner:n}=t;if(s&&(e.positional.prepend(s.positional),e.named.merge(s.named)),!en(n))return n;t=n}}get offset(){let{inner:e,args:t}=this,s=t?t.positional.length:0;return en(e)?s+e.offset:s}}function sn(e,t,s){return e.lookupComponent(t,s)}Zs=Qs;class nn{constructor(e){this.list=e,this.tag=$s(e),this.list=e}value(){let e=[],{list:t}=this;for(let s=0;s<t.length;s++){let n=Ht(t[s].value());n&&e.push(n)}return 0===e.length?null:e.join(" ")}}class rn{constructor(e,t,s,n){this.inner=e,this.resolver=t,this.meta=s,this.args=n,this.tag=e.tag,this.lastValue=null,this.lastDefinition=null}value(){let{inner:e,lastValue:t}=this,s=e.value();if(s===t)return this.lastDefinition;let n=null;if(en(s))n=s;else if("string"==typeof s&&s){let{resolver:e,meta:t}=this;n=sn(e,s,t)}return n=this.curry(n),this.lastValue=s,this.lastDefinition=n,n}get(){return Bt}curry(e){let{args:t}=this;return!t&&en(e)?e:e?new tn(e,t):null}}class an extends Vs{constructor(e,t,s){super(),this.node=e,this.reference=t,this.lastValue=s,this.type="dynamic-text",this.tag=t.tag,this.lastRevision=o(this.tag)}evaluate(){let{reference:e,tag:t}=this;u(t,this.lastRevision)||(this.lastRevision=o(),this.update(e.value()))}update(e){let t,{lastValue:s}=this;if(e!==s&&(t=Ft(e)?"":Wt(e)?e:String(e),t!==s)){this.node.nodeValue=this.lastValue=t}}}class ln{constructor(e){this.inner=e,this.tag=e.tag}value(){let e=this.inner.value();return function(e){return Wt(e)||Ft(e)||"boolean"==typeof e||"number"==typeof e}(e)?1:(t=e)&&t[Qs]?0:Vt(e)?3:function(e){return $t(e)&&11===e.nodeType}(e)?4:$t(e)?5:1;var t}}Fs.add(43,e=>{let t=e.stack.pop().value(),s=Ft(t)?"":String(t);e.elements().appendDynamicHTML(s)}),Fs.add(44,e=>{let t=e.stack.pop().value().toHTML(),s=Ft(t)?"":t;e.elements().appendDynamicHTML(s)}),Fs.add(47,e=>{let t=e.stack.pop(),s=t.value(),n=Ft(s)?"":String(s),r=e.elements().appendDynamicText(n);b(t)||e.updateWith(new an(r,t,n))}),Fs.add(45,e=>{let t=e.stack.pop().value();e.elements().appendDynamicFragment(t)}),Fs.add(46,e=>{let t=e.stack.pop().value();e.elements().appendDynamicNode(t)}),Fs.add(39,e=>e.pushChildScope()),Fs.add(40,e=>e.popScope()),Fs.add(59,e=>e.pushDynamicScope()),Fs.add(60,e=>e.popDynamicScope()),Fs.add(29,(e,{op1:t})=>{e.stack.push(e[_e].getOther(t))}),Fs.add(30,(e,{op1:t})=>{let s=e.stack;if(fe(t)){let n;n=t>-1073741825?e[_e].getString(be(t,-1)):e[_e].getNumber(be(t,-1073741825)),s.pushJs(n)}else s.pushRaw(t)}),Fs.add(31,e=>{let t=e.stack;t.push(Ot.create(t.pop()))}),Fs.add(32,e=>{let t=e.stack;t.push(t.peek().value())}),Fs.add(33,(e,{op1:t,op2:s})=>{let n=e.fetchValue(t)-s;e.stack.dup(n)}),Fs.add(34,(e,{op1:t})=>{e.stack.pop(t)}),Fs.add(35,(e,{op1:t})=>{e.load(t)}),Fs.add(36,(e,{op1:t})=>{e.fetch(t)}),Fs.add(58,(e,{op1:t})=>{let s=e[_e].getArray(t);e.bindDynamicScope(s)}),Fs.add(69,(e,{op1:t})=>{e.enter(t)}),Fs.add(70,e=>{e.exit()}),Fs.add(63,(e,{op1:t})=>{e.stack.push(e[_e].getSerializable(t))}),Fs.add(62,e=>{e.stack.push(e.scope())}),Fs.add(61,e=>{let t=e.stack,s=t.pop();s?t.push(e.compile(s)):t.push(null)},"jit"),Fs.add(64,e=>{let{stack:t}=e,s=t.pop(),n=t.pop(),r=t.pop(),i=t.pop();if(null===r)return e.pushFrame(),void e.pushScope(n);let a=n;{let e=r.parameters,t=e.length;if(t>0){a=a.child();for(let s=0;s<t;s++)a.bindSymbol(e[s],i.at(s))}}e.pushFrame(),e.pushScope(a),e.call(s)}),Fs.add(65,(e,{op1:t})=>{let s=e.stack.pop();if(b(s))s.value()&&e.goto(t);else{let n=new Ke(s);n.peek()&&e.goto(t),e.updateWith(new on(n))}}),Fs.add(66,(e,{op1:t})=>{let s=e.stack.pop();if(b(s))s.value()||e.goto(t);else{let n=new Ke(s);n.peek()||e.goto(t),e.updateWith(new on(n))}}),Fs.add(67,(e,{op1:t,op2:s})=>{e.stack.peek()===s&&e.goto(t)}),Fs.add(68,e=>{let t=e.stack.peek();b(t)||e.updateWith(on.initialize(new Ke(t)))}),Fs.add(71,e=>{let{env:t,stack:s}=e;s.push(t.toConditionalReference(s.pop()))});class on extends Vs{constructor(e){super(),this.type="assert",this.tag=e.tag,this.cache=e}static initialize(e){let t=new on(e);return e.peek(),t}evaluate(e){let{cache:t}=this;t.revalidate()!==qe&&e.throw()}}class un extends Vs{constructor(e,t){super(),this.target=t,this.type="jump-if-not-modified",this.tag=e,this.lastRevision=o()}evaluate(e){let{tag:t,target:s,lastRevision:n}=this;!e.alwaysRevalidate&&u(t,n)&&e.goto(s)}didModify(){this.lastRevision=o(this.tag)}}class cn extends Vs{constructor(e){super(),this.target=e,this.type="did-modify",this.tag=g}evaluate(){this.target.didModify()}}class hn{constructor(e){this.tag=g,this.type="label",this.label=null,this.prev=null,this.next=null,z(this),this.label=e}evaluate(){}inspect(){return`${this.label} [${this._guid}]`}}Fs.add(41,(e,{op1:t})=>{e.elements().appendText(e[_e].getString(t))}),Fs.add(42,(e,{op1:t})=>{e.elements().appendComment(e[_e].getString(t))}),Fs.add(48,(e,{op1:t})=>{e.elements().openElement(e[_e].getString(t))}),Fs.add(49,e=>{let t=e.stack.pop().value();e.elements().openElement(t)}),Fs.add(50,e=>{let t,s,n=e.stack.pop(),r=e.stack.pop(),i=e.stack.pop().value();if(b(n))t=n.value();else{let s=new Ke(n);t=s.peek(),e.updateWith(new on(s))}if(void 0!==r.value())if(b(r))s=r.value();else{let t=new Ke(r);s=t.peek(),e.updateWith(new on(t))}let a=e.elements().pushRemoteElement(t,i,s);a&&e.associateDestroyable(a)}),Fs.add(56,e=>{e.elements().popRemoteElement()}),Fs.add(54,e=>{let t=e.fetchValue(6),s=null;t&&(s=t.flush(e),e.loadValue(6,null)),e.elements().flushElement(s)}),Fs.add(55,e=>{let t=e.elements().closeElement();t&&t.forEach(([t,s])=>{e.env.scheduleInstallModifier(s,t);let n=t.getDestructor(s);n&&e.associateDestroyable(n)})}),Fs.add(57,(e,{op1:t})=>{let{manager:s,state:n}=e.runtime.resolver.resolve(t),r=e.stack.pop(),{constructing:i,updateOperations:a}=e.elements(),l=e.dynamicScope(),o=s.create(i,n,r,l,a);e.fetchValue(6).addModifier(s,o);let u=s.getTag(o);y(u)||e.updateWith(new pn(u,s,o))});class pn extends Vs{constructor(e,t,s){super(),this.tag=e,this.manager=t,this.modifier=s,this.type="update-modifier",this.lastUpdated=o()}evaluate(e){let{manager:t,modifier:s,tag:n,lastUpdated:r}=this;u(n,r)||(e.env.scheduleUpdateModifier(s,t),this.lastUpdated=o())}}Fs.add(51,(e,{op1:t,op2:s,op3:n})=>{let r=e[_e].getString(t),i=e[_e].getString(s),a=n?e[_e].getString(n):null;e.elements().setStaticAttribute(r,i,a)}),Fs.add(52,(e,{op1:t,op2:s,op3:n})=>{let r=e[_e].getString(t),i=e.stack.pop(),a=i.value(),l=n?e[_e].getString(n):null,o=e.elements().setDynamicAttribute(r,a,!!s,l);b(i)||e.updateWith(new dn(i,o))});class dn extends Vs{constructor(e,t){super(),this.reference=e,this.attribute=t,this.type="patch-element";let{tag:s}=e;this.tag=s,this.lastRevision=o()}evaluate(e){let{attribute:t,reference:s,tag:n}=this;u(n,this.lastRevision)||(t.update(s.value(),e.env),this.lastRevision=o())}}const mn=$("COMPONENT_INSTANCE");Fs.add(77,e=>{let t=e.stack,s=t.pop();t.push(new Ut(s,en))}),Fs.add(78,e=>{let t=e.stack,s=t.peek();t.push(new ln(s))}),Fs.add(79,(e,{op1:t})=>{let s=e.stack,n=s.pop(),r=s.pop(),i=e[_e].getTemplateMeta(t),a=e.runtime.resolver;e.loadValue(8,new rn(n,a,i,r))}),Fs.add(80,(e,{op1:t})=>{let s=e.runtime.resolver.resolve(t),{manager:n}=s,r=Ks(n.getCapabilities(s.state)),i={[mn]:!0,definition:s,manager:n,capabilities:r,state:null,handle:null,table:null,lookup:null};e.stack.push(i)}),Fs.add(83,(e,{op1:t})=>{let s,n=e.stack,r=n.pop().value(),i=e[_e].getTemplateMeta(t);if(e.loadValue(7,null),"string"==typeof r){s=sn(e.runtime.resolver,r,i)}else{if(!en(r))throw F();s=r}n.push(s)}),Fs.add(81,e=>{let t,s,{stack:n}=e,r=n.pop();en(r)?s=t=null:(s=r.manager,t=Ks(s.getCapabilities(r.state))),n.push({definition:r,capabilities:t,manager:s,state:null,handle:null,table:null})}),Fs.add(82,e=>{let t,s=e.stack,n=s.pop().value();if(!en(n))throw F();t=n,s.push(t)}),Fs.add(84,(e,{op1:t,op2:s,op3:n})=>{let r=e.stack,i=e[_e].getStringArray(t),a=n>>4,l=8&n,o=7&n?e[_e].getStringArray(s):B;e[Te].setup(r,i,o,a,!!l),r.push(e[Te])}),Fs.add(85,e=>{let{stack:t}=e;t.push(e[Te].empty(t))}),Fs.add(88,e=>{let t=e.stack,s=t.pop().capture();t.push(s)}),Fs.add(87,(e,{op1:t})=>{let s=e.stack,n=e.fetchValue(t),r=s.pop(),{definition:i}=n;en(i)&&(i=function(e,t,s){let n=e.definition=t.unwrap(s),{manager:r,state:i}=n;return e.manager=r,e.capabilities=Ks(r.getCapabilities(i)),n}(n,i,r));let{manager:a,state:l}=i;if(!qs(0,n.capabilities,4))return void s.push(r);let o=r.blocks.values,u=r.blocks.names,c=a.prepareArgs(l,r);if(c){r.clear();for(let e=0;e<o.length;e++)s.push(o[e]);let{positional:e,named:t}=c,n=e.length;for(let t=0;t<n;t++)s.push(e[t]);let i=Object.keys(t);for(let e=0;e<i.length;e++)s.push(t[i[e]]);r.setup(s,i,u,n,!1)}s.push(r)}),Fs.add(89,(e,{op1:t,op2:s})=>{let n=e.fetchValue(s),{definition:r,manager:i}=n,a=n.capabilities=Ks(i.getCapabilities(r.state));if(!qs(0,a,512))throw new Error("BUG");let l=null;qs(0,a,64)&&(l=e.dynamicScope());let o=1&t,u=null;qs(0,a,8)&&(u=e.stack.peek());let c=null;qs(0,a,128)&&(c=e.getSelf());let h=i.create(e.env,r.state,u,l,c,!!o);n.state=h;let p=i.getTag(h);qs(0,a,256)&&!y(p)&&e.updateWith(new kn(p,h,i,l))}),Fs.add(90,(e,{op1:t})=>{let{manager:s,state:n,capabilities:r}=e.fetchValue(t),i=s.getDestructor(n);i&&e.associateDestroyable(i)}),Fs.add(100,e=>{e.beginCacheGroup(),e.elements().pushSimpleBlock()}),Fs.add(91,e=>{e.loadValue(6,new fn)}),Fs.add(53,(e,{op1:t,op2:s,op3:n})=>{let r=e[_e].getString(t),i=e.stack.pop(),a=n?e[_e].getString(n):null;e.fetchValue(6).setAttribute(r,i,!!s,a)}),Fs.add(108,(e,{op1:t,op2:s,op3:n})=>{let r=e[_e].getString(t),i=e[_e].getString(s),a=n?e[_e].getString(n):null;e.fetchValue(6).setStaticAttribute(r,i,a)});class fn{constructor(){this.attributes=U(),this.classes=[],this.modifiers=[]}setAttribute(e,t,s,n){let r={value:t,namespace:n,trusting:s};"class"===e&&this.classes.push(t),this.attributes[e]=r}setStaticAttribute(e,t,s){let n={value:t,namespace:s};"class"===e&&this.classes.push(t),this.attributes[e]=n}addModifier(e,t){this.modifiers.push([e,t])}flush(e){let t,s=this.attributes;for(let n in this.attributes){if("type"===n){t=s[n];continue}let r=this.attributes[n];"class"===n?bn(e,"class",gn(this.classes),r.namespace,r.trusting):bn(e,n,r.value,r.namespace,r.trusting)}return void 0!==t&&bn(e,"type",t.value,t.namespace,t.trusting),this.modifiers}}function gn(e){return 0===e.length?"":1===e.length?e[0]:function(e){for(let t=0;t<e.length;t++)if("string"!=typeof e[t])return!1;return!0}(e)?e.join(" "):function(e){for(let t=0;t<e.length;t++){const s=e[t];"string"==typeof s&&(e[t]=Ot.create(s))}return new nn(e)}(e)}function bn(e,t,s,n,r=!1){if("string"==typeof s)e.elements().setStaticAttribute(t,s,n);else{let i=e.elements().setDynamicAttribute(t,s.value(),r,n);b(s)||e.updateWith(new dn(s,i))}}function yn(e,t){return!1===qs(0,e,1)}function vn(e,t){return!0===qs(0,e,1)}function wn(e,t,s,n,r){let i=s.table.symbols.indexOf(e),a=n.get(t);-1!==i&&r.scope().bindBlock(i+1,a),s.lookup&&(s.lookup[e]=a)}Fs.add(102,(e,{op1:t})=>{let{definition:s,state:n}=e.fetchValue(t),{manager:r}=s,i=e.fetchValue(6);r.didCreateElement(n,e.elements().constructing,i)}),Fs.add(92,(e,{op1:t})=>{let{definition:s,state:n}=e.fetchValue(t),{manager:r}=s;e.stack.push(r.getSelf(n))}),Fs.add(93,(e,{op1:t})=>{let{definition:s,state:n}=e.fetchValue(t),{manager:r}=s;e.stack.push(r.getTagName(n))}),Fs.add(95,(e,{op1:t})=>{let s,n=e.fetchValue(t),r=n.manager,{definition:i}=n,{stack:a}=e,{capabilities:l}=n;if(yn(l,r))s=r.getJitStaticLayout(i.state,e.runtime.resolver);else{if(!vn(l,r))throw F();{let t=ve(r.getJitDynamicLayout(n.state,e.runtime.resolver));s=Xs(l,1024)?t.asWrappedLayout():t.asLayout()}}let o=s.compile(e.context);a.push(s.symbolTable),a.push(o)},"jit"),Fs.add(94,(e,{op1:t})=>{let s,n=e.fetchValue(t),{manager:r,definition:i}=n,{stack:a}=e,{state:l,capabilities:o}=n,{state:u}=i;if(yn(o,r))s=r.getAotStaticLayout(u,e.runtime.resolver);else{if(!vn(o,r))throw F();s=r.getAotDynamicLayout(l,e.runtime.resolver)}a.push(s.symbolTable),a.push(s.handle)}),Fs.add(76,(e,{op1:t})=>{let s=e.stack.pop(),n=e.stack.pop(),{manager:r}=s,i=Ks(r.getCapabilities(s.state)),a={[mn]:!0,definition:s,manager:r,capabilities:i,state:null,handle:n.handle,table:n.symbolTable,lookup:null};e.loadValue(t,a)}),Fs.add(98,(e,{op1:t})=>{let{stack:s}=e,n=s.pop(),r=s.pop(),i=e.fetchValue(t);i.handle=n,i.table=r}),Fs.add(38,(e,{op1:t})=>{let{symbols:s}=e.fetchValue(t).table;e.pushRootScope(s.length+1)}),Fs.add(97,(e,{op1:t})=>{let s=e.fetchValue(t);if(s.table.hasEval){let t=s.lookup=U();e.scope().bindEvalScope(t)}}),Fs.add(17,(e,{op1:t})=>{let s=e.fetchValue(t),n=e.scope(),r=e.stack.peek(),i=r.named.atNames;for(let e=i.length-1;e>=0;e--){let t=i[e],a=s.table.symbols.indexOf(i[e]),l=r.named.get(t,!0);-1!==a&&n.bindSymbol(a+1,l),s.lookup&&(s.lookup[t]=l)}}),Fs.add(18,(e,{op1:t})=>{let s=e.fetchValue(t),{blocks:n}=e.stack.peek();for(let t=0;t<n.names.length;t++)wn(n.symbolNames[t],n.names[t],s,n,e)}),Fs.add(99,(e,{op1:t})=>{let s=e.fetchValue(t);e.call(s.handle)}),Fs.add(103,(e,{op1:t})=>{let{manager:s,state:n,capabilities:r}=e.fetchValue(t),i=e.elements().popBlock();if(!qs(0,r,512))throw new Error("BUG");s.didRenderLayout(n,i),e.env.didCreate(n,s),e.updateWith(new xn(s,n,i))}),Fs.add(101,e=>{e.commitCacheGroup()});class kn extends Vs{constructor(e,t,s,n){super(),this.tag=e,this.component=t,this.manager=s,this.dynamicScope=n,this.type="update-component"}evaluate(e){let{component:t,manager:s,dynamicScope:n}=this;s.update(t,n)}}class xn extends Vs{constructor(e,t,s){super(),this.manager=e,this.component=t,this.bounds=s,this.type="did-update-layout",this.tag=g}evaluate(e){let{manager:t,component:s,bounds:n}=this;t.didUpdateLayout(s,n),e.env.didUpdate(s,t)}}function Sn(e,t){console.info("Use `context`, and `get(<path>)` to debug this template."),t("this")}let En=Sn;class Cn{constructor(e,t,s){this.scope=e,this.locals=U();for(let n=0;n<s.length;n++){let r=s[n],i=t[r-1],a=e.getSymbol(r);this.locals[i]=a}}get(e){let t,{scope:s,locals:n}=this,r=e.split("."),[i,...a]=e.split("."),l=s.getEvalScope();return"this"===i?t=s.getSelf():n[i]?t=n[i]:0===i.indexOf("@")&&l[i]?t=l[i]:(t=this.scope.getSelf(),a=r),a.reduce((e,t)=>e.get(t),t)}}Fs.add(106,(e,{op1:t,op2:s})=>{let n=e[_e].getStringArray(t),r=e[_e].getArray(s),i=new Cn(e.scope(),n,r);En(e.getSelf().value(),e=>i.get(e).value())}),Fs.add(104,(e,{op1:t,op2:s,op3:n})=>{let{[_e]:r,stack:i}=e,a=i.pop().value(),l=r.getTemplateMeta(t),o=r.getStringArray(s),u=r.getArray(n),c=e.runtime.resolver.lookupPartial(a,l),h=e.runtime.resolver.resolve(c),{symbolTable:p,handle:d}=h.getPartial(e.context);{let t=p.symbols,s=e.scope(),n=e.pushRootScope(t.length),r=s.getEvalScope();n.bindEvalScope(r),n.bindSelf(s.getSelf());let i=Object.create(s.getPartialMap());for(let e=0;e<u.length;e++){let t=u[e],n=o[t-1],r=s.getSymbol(t);i[n]=r}if(r)for(let e=0;e<t.length;e++){let s=e+1,i=r[t[e]];void 0!==i&&n.bind(s,i)}n.bindPartialMap(i),e.pushFrame(),e.call(ye(d))}},"jit");class An{constructor(e){this.tag=e.tag,this.artifacts=e}value(){return!this.artifacts.isEmpty()}}Fs.add(74,e=>{let t=e.stack,s=t.pop(),n=t.pop(),r=e.env.iterableFor(s,n.value()),i=new tt(r);t.push(i),t.push(new An(i.artifacts))}),Fs.add(72,(e,{op1:t})=>{e.enterList(t)}),Fs.add(73,e=>{e.exitList()}),Fs.add(75,(e,{op1:t})=>{let s=e.stack.peek().next();if(s){let t=e.iterate(s.memo,s.value);e.enterItem(s.key,t)}else e.goto(t)});const Nn={dynamicLayout:!1,dynamicTag:!1,prepareArgs:!1,createArgs:!1,attributeHook:!1,elementHook:!1,dynamicScope:!1,createCaller:!1,updateHook:!1,createInstance:!1,wrapped:!1,willDestroy:!1};new class{getCapabilities(e){return Nn}prepareArgs(e,t){throw new Error("Unimplemented prepareArgs in SimpleComponentManager")}create(e,t,s,n,r,i){throw new Error("Unimplemented create in SimpleComponentManager")}getSelf(e){return Bt}getTag(e){throw new Error("Unimplemented getTag in SimpleComponentManager")}didRenderLayout(e,t){throw new Error("Unimplemented didRenderLayout in SimpleComponentManager")}didCreate(e){throw new Error("Unimplemented didCreate in SimpleComponentManager")}update(e,t){throw new Error("Unimplemented update in SimpleComponentManager")}didUpdateLayout(e,t){throw new Error("Unimplemented didUpdateLayout in SimpleComponentManager")}didUpdate(e){throw new Error("Unimplemented didUpdate in SimpleComponentManager")}getDestructor(e){return null}};class Mn{constructor(e){this.bucket=e?pe({},e):{}}get(e){return this.bucket[e]}set(e,t){return this.bucket[e]=t}child(){return new Mn(this.bucket)}}class _n{constructor(){this.stack=null,this.positional=new Tn,this.named=new On,this.blocks=new Bn}empty(e){let t=e[Ne][3]+1;return this.named.empty(e,t),this.positional.empty(e,t),this.blocks.empty(e,t),this}setup(e,t,s,n,r){this.stack=e;let i=this.named,a=t.length,l=e[Ne][3]-a+1;i.setup(e,l,a,t,r);let o=l-n;this.positional.setup(e,o,n);let u=this.blocks,c=s.length,h=o-3*c;u.setup(e,h,c,s)}get tag(){return $s([this.positional,this.named])}get base(){return this.blocks.base}get length(){return this.positional.length+this.named.length+3*this.blocks.length}at(e){return this.positional.at(e)}realloc(e){let{stack:t}=this;if(e>0&&null!==t){let{positional:s,named:n}=this,r=s.base+e;for(let e=s.length+n.length-1;e>=0;e--)t.copy(e+s.base,e+r);s.base+=e,n.base+=e,t[Ne][3]+=e}}capture(){let e=0===this.positional.length?Un:this.positional.capture(),t=0===this.named.length?zn:this.named.capture();return new In(this.tag,e,t,this.length)}clear(){let{stack:e,length:t}=this;t>0&&null!==e&&e.pop(t)}}class Tn{constructor(){this.base=0,this.length=0,this.stack=null,this._tag=null,this._references=null}empty(e,t){this.stack=e,this.base=t,this.length=0,this._tag=g,this._references=B}setup(e,t,s){this.stack=e,this.base=t,this.length=s,0===s?(this._tag=g,this._references=B):(this._tag=null,this._references=null)}get tag(){let e=this._tag;return e||(e=this._tag=$s(this.references)),e}at(e){let{base:t,length:s,stack:n}=this;return e<0||e>=s?Bt:n.get(e,t)}capture(){return new Rn(this.tag,this.references)}prepend(e){let t=e.length;if(t>0){let{base:s,length:n,stack:r}=this;this.base=s-=t,this.length=n+t;for(let n=0;n<t;n++)r.set(e.at(n),n,s);this._tag=null,this._references=null}}get references(){let e=this._references;if(!e){let{stack:t,base:s,length:n}=this;e=this._references=t.sliceArray(s,s+n)}return e}}class Rn{constructor(e,t,s=t.length){this.tag=e,this.references=t,this.length=s}static empty(){return new Rn(g,B,0)}at(e){return this.references[e]}value(){return this.references.map(this.valueOf)}get(e){let{references:t,length:s}=this;if("length"===e)return Ot.create(s);{let n=parseInt(e,10);return n<0||n>=s?Bt:t[n]}}valueOf(e){return e.value()}}class On{constructor(){this.base=0,this.length=0,this._references=null,this._names=B,this._atNames=B}empty(e,t){this.stack=e,this.base=t,this.length=0,this._references=B,this._names=B,this._atNames=B}setup(e,t,s,n,r){this.stack=e,this.base=t,this.length=s,0===s?(this._references=B,this._names=B,this._atNames=B):(this._references=null,r?(this._names=null,this._atNames=n):(this._names=n,this._atNames=null))}get tag(){return $s(this.references)}get names(){let e=this._names;return e||(e=this._names=this._atNames.map(this.toSyntheticName)),e}get atNames(){let e=this._atNames;return e||(e=this._atNames=this._names.map(this.toAtName)),e}has(e){return-1!==this.names.indexOf(e)}get(e,t=!1){let{base:s,stack:n}=this,r=(t?this.atNames:this.names).indexOf(e);return-1===r?Bt:n.get(r,s)}capture(){return new Pn(this.tag,this.names,this.references)}merge(e){let{length:t}=e;if(t>0){let{names:s,length:n,stack:r}=this,{names:i}=e;Object.isFrozen(s)&&0===s.length&&(s=[]);for(let a=0;a<t;a++){let t=i[a];-1===s.indexOf(t)&&(n=s.push(t),r.push(e.references[a]))}this.length=n,this._references=null,this._names=s,this._atNames=null}}get references(){let e=this._references;if(!e){let{base:t,length:s,stack:n}=this;e=this._references=n.sliceArray(t,t+s)}return e}toSyntheticName(e){return e.slice(1)}toAtName(e){return"@"+e}}class Pn{constructor(e,t,s){this.tag=e,this.names=t,this.references=s,this.length=t.length,this._map=null}get map(){let e=this._map;if(!e){let{names:t,references:s}=this;e=this._map=U();for(let n=0;n<t.length;n++){e[t[n]]=s[n]}}return e}has(e){return-1!==this.names.indexOf(e)}get(e){let{names:t,references:s}=this,n=t.indexOf(e);return-1===n?Bt:s[n]}value(){let{names:e,references:t}=this,s=U();for(let n=0;n<e.length;n++){s[e[n]]=t[n].value()}return s}}function Ln(e){return"&"+e}class Bn{constructor(){this.internalValues=null,this._symbolNames=null,this.internalTag=null,this.names=B,this.length=0,this.base=0}empty(e,t){this.stack=e,this.names=B,this.base=t,this.length=0,this._symbolNames=null,this.internalTag=g,this.internalValues=B}setup(e,t,s,n){this.stack=e,this.names=n,this.base=t,this.length=s,this._symbolNames=null,0===s?(this.internalTag=g,this.internalValues=B):(this.internalTag=null,this.internalValues=null)}get values(){let e=this.internalValues;if(!e){let{base:t,length:s,stack:n}=this;e=this.internalValues=n.sliceArray(t,t+3*s)}return e}has(e){return-1!==this.names.indexOf(e)}get(e){let t=this.names.indexOf(e);if(-1===t)return null;let{base:s,stack:n}=this,r=n.get(3*t,s),i=n.get(3*t+1,s),a=n.get(3*t+2,s);return null===a?null:[a,i,r]}capture(){return new Dn(this.names,this.values)}get symbolNames(){let e=this._symbolNames;return null===e&&(e=this._symbolNames=this.names.map(Ln)),e}}class Dn{constructor(e,t){this.names=e,this.values=t,this.length=e.length}has(e){return-1!==this.names.indexOf(e)}get(e){let t=this.names.indexOf(e);return-1===t?null:[this.values[3*t+2],this.values[3*t+1],this.values[3*t]]}}class In{constructor(e,t,s,n){this.tag=e,this.positional=t,this.named=s,this.length=n}value(){return{named:this.named.value(),positional:this.positional.value()}}}const zn=new Pn(g,B,B),Un=new Rn(g,B);new In(g,Un,zn,0);class jn{constructor(e,t,s,n,r){this.stack=e,this.heap=t,this.program=s,this.externs=n,this.registers=r,this.currentOpSize=0}fetchRegister(e){return this.registers[e]}loadRegister(e,t){this.registers[e]=t}setPc(e){this.registers[0]=e}pushFrame(){this.stack.push(this.registers[1]),this.stack.push(this.registers[2]),this.registers[2]=this.registers[3]-1}popFrame(){this.registers[3]=this.registers[2]-1,this.registers[1]=this.stack.get(0),this.registers[2]=this.stack.get(1)}pushSmallFrame(){this.stack.push(this.registers[1])}popSmallFrame(){this.registers[1]=this.stack.pop()}goto(e){this.setPc(this.target(e))}target(e){return this.registers[0]+e-this.currentOpSize}call(e){this.registers[1]=this.registers[0],this.setPc(this.heap.getaddr(e))}returnTo(e){this.registers[1]=this.target(e)}return(){this.setPc(this.registers[1])}nextStatement(){let{registers:e,program:t}=this,s=e[0];if(-1===s)return null;let n=t.opcode(s),r=this.currentOpSize=n.size;return this.registers[0]+=r,n}evaluateOuter(e,t){this.evaluateInner(e,t)}evaluateInner(e,t){e.isMachine?this.evaluateMachine(e):this.evaluateSyscall(e,t)}evaluateMachine(e){switch(e.type){case 0:return this.pushFrame();case 1:return this.popFrame();case 3:return this.call(e.op1);case 2:return this.call(this.stack.pop());case 4:return this.goto(e.op1);case 5:return this.return();case 6:return this.returnTo(e.op1)}}evaluateSyscall(e,t){Fs.evaluate(t,e,e.type)}}class Hn{constructor(e,{alwaysRevalidate:t=!1}){this.frameStack=new H,this.env=e,this.dom=e.getDOM(),this.alwaysRevalidate=t}execute(e,t){let{frameStack:s}=this;for(this.try(e,t);!s.isEmpty();){let e=this.frame.nextStatement();null!==e?e.evaluate(this):s.pop()}}get frame(){return this.frameStack.current}goto(e){this.frame.goto(e)}try(e,t){this.frameStack.push(new Gn(e,t))}throw(){this.frame.handleException(),this.frameStack.pop()}}class Fn{constructor(e,t){this.state=e,this.resumeCallback=t}resume(e,t){return this.resumeCallback(e,this.state,t)}}class Vn extends Vs{constructor(e,t,s,n){super(),this.state=e,this.runtime=t,this.type="block",this.next=null,this.prev=null,this.children=n,this.bounds=s}parentElement(){return this.bounds.parentElement()}firstNode(){return this.bounds.firstNode()}lastNode(){return this.bounds.lastNode()}evaluate(e){e.try(this.children,null)}}class $n extends Vn{constructor(e,t,s,n){super(e,t,s,n),this.type="try",this.tag=this._tag=f()}didInitializeChildren(){d(this._tag,Ws(this.children))}evaluate(e){e.try(this.children,this)}handleException(){let{state:e,bounds:t,children:s,prev:n,next:r,runtime:i}=this;De(this,i.env),s.clear(),Ie(this,i.env);let a=$e.resume(i.env,t),l=e.resume(i,a),o=new ue;Q(this,l.execute(e=>{e.pushUpdating(o),e.updateWith(this),e.pushUpdating(s)}).drop),this.prev=n,this.next=r}}class Wn{constructor(e,t){this.opcode=e,this.marker=t,this.didInsert=!1,this.didDelete=!1,this.map=e.map,this.updating=e.children}insert(e,t,s,n,r){let{map:i,opcode:a,updating:l}=this,o=null,u=null;u=i.get(r),o=void 0!==u?u.bounds.firstNode():this.marker;let c=a.vmForInsertion(o),h=null,p=c.execute(e=>{h=e.iterate(n,s),i.set(t,h),e.pushUpdating(new ue),e.updateWith(h),e.pushUpdating(h.children)});l.insertBefore(h,u),Q(a,p.drop),this.didInsert=!0}retain(e,t,s,n){}move(e,t,s,n,r){let{map:i,updating:a}=this,l=i.get(t);if(r===nt)Le(l,this.marker),a.remove(l),a.append(l);else{let e=i.get(r);Le(l,e.firstNode()),a.remove(l),a.insertBefore(l,e)}}delete(e,t){let{map:s,updating:n}=this,r=s.get(t);!function(e,t){ze(e,t),Be(e),Ue(e,t)}(r,e),n.remove(r),s.delete(t),this.didDelete=!0}done(){this.opcode.didInitializeChildren(this.didInsert||this.didDelete)}}class Jn extends Vn{constructor(e,t,s,n,r){super(e,t,s,n),this.type="list-block",this.map=new Map,this.lastIterated=1,this.artifacts=r;let i=this._tag=f();this.tag=v([r.tag,i])}didInitializeChildren(e=!0){this.lastIterated=o(this.artifacts.tag),e&&d(this._tag,Ws(this.children))}evaluate(e){let{artifacts:t,lastIterated:s}=this;if(!u(t.tag,s)){let{bounds:s}=this,{dom:n}=e,r=n.createComment("");n.insertAfter(s.parentElement(),r,s.lastNode());let i=new Wn(this,r);new rt({target:i,artifacts:t,env:e.env}).sync(),this.parentElement().removeChild(r)}super.evaluate(e)}vmForInsertion(e){let{bounds:t,state:s,runtime:n}=this,r=$e.forInitialRender(n.env,{element:t.parentElement(),nextSibling:e});return s.resume(n,r)}}class Gn{constructor(e,t){this.ops=e,this.exceptionHandler=t,this.current=e.head()}goto(e){this.current=e}nextStatement(){let{current:e,ops:t}=this;return e&&(this.current=t.nextNode(e)),e}handleException(){this.exceptionHandler&&this.exceptionHandler.handleException()}}class Yn{constructor(e,t,s,n){this.env=e,this.updating=t,this.bounds=s,this.drop=n,Q(this,n)}rerender({alwaysRevalidate:e=!1}={alwaysRevalidate:!1}){let{env:t,updating:s}=this;new Hn(t,{alwaysRevalidate:e}).execute(s,this)}parentElement(){return this.bounds.parentElement()}firstNode(){return this.bounds.firstNode()}lastNode(){return this.bounds.lastNode()}handleException(){throw"this should never happen"}[W](){Be(this.bounds)}destroy(){!function(e,t){if(e[Rs])t();else{e.begin();try{t()}finally{e.commit()}}}(this.env,()=>{ze(this,this.env),Ue(this,this.env)})}}class Kn{constructor(e=[]){this.vec=e}clone(){return new Kn(this.vec.slice())}sliceFrom(e){return new Kn(this.vec.slice(e))}slice(e,t){return new Kn(this.vec.slice(e,t))}copy(e,t){this.vec[t]=this.vec[e]}writeRaw(e,t){this.vec[e]=t}getRaw(e){return this.vec[e]}reset(){this.vec.length=0}len(){return this.vec.length}}class qn{constructor(e=new Kn,t=[]){this.inner=e,this.js=t}slice(e,t){let s;return s="number"==typeof e&&"number"==typeof t?this.inner.slice(e,t):"number"==typeof e&&void 0===t?this.inner.sliceFrom(e):this.inner.clone(),new qn(s,this.js.slice(e,t))}sliceInner(e,t){let s=[];if(-1===e)return s;for(let n=e;n<t;n++)s.push(this.get(n));return s}copy(e,t){this.inner.copy(e,t)}write(e,t){switch(typeof t){case"boolean":case"undefined":this.writeRaw(e,de(t));break;case"number":if(me(t)){this.writeRaw(e,de(t));break}case"object":if(null===t){this.writeRaw(e,de(t));break}default:this.writeJs(e,t)}}writeJs(e,t){let s=this.js.length;this.js.push(t),this.inner.writeRaw(e,ge(s))}writeRaw(e,t){this.inner.writeRaw(e,t)}get(e){let t=this.inner.getRaw(e);return fe(t)?this.js[be(t)]:function(e){if(e>1073741823)switch(e){case 1073741824:return!1;case 1073741825:return!0;case 1073741826:return null;case 1073741827:return;default:return 1073741827-e}return e}(t)}reset(){this.inner.reset(),this.js.length=0}get length(){return this.inner.len()}}var Xn,Zn;class Qn{constructor(){this.scope=new H,this.dynamicScope=new H,this.updating=new H,this.cache=new H,this.list=new H}}class er{constructor(e,{pc:t,scope:s,dynamicScope:n,stack:r},i){this.runtime=e,this.elementStack=i,this[Xn]=new Qn,this[Zn]=new H,this.s0=null,this.s1=null,this.t0=null,this.t1=null,this.v0=null;let a=class{constructor(e,t){this.stack=e,this[Ne]=t}static restore(e){let t=new qn;for(let s=0;s<e.length;s++)t.write(s,e[s]);return new this(t,[0,-1,e.length-1,0])}push(e){this.stack.write(++this[Ne][3],e)}pushJs(e){this.stack.writeJs(++this[Ne][3],e)}pushRaw(e){this.stack.writeRaw(++this[Ne][3],e)}dup(e=this[Ne][3]){this.stack.copy(e,++this[Ne][3])}copy(e,t){this.stack.copy(e,t)}pop(e=1){let t=this.stack.get(this[Ne][3]);return this[Ne][3]-=e,t}peek(e=0){return this.stack.get(this[Ne][3]-e)}get(e,t=this[Ne][2]){return this.stack.get(t+e)}set(e,t,s=this[Ne][2]){this.stack.write(s+t,e)}slice(e,t){return this.stack.slice(e,t)}sliceArray(e,t){return this.stack.sliceInner(e,t)}capture(e){let t=this[Ne][3]+1,s=t-e;return this.stack.sliceInner(s,t)}reset(){this.stack.reset()}toArray(){return console.log(this[Ne]),this.stack.sliceInner(this[Ne][2],this[Ne][3]+1)}}.restore(r);a[Ne][0]=t,a[Ne][3]=r.length-1,a[Ne][2]=-1,this[Me]=this.program.heap,this[_e]=this.program.constants,this.elementStack=i,this[Ae].scope.push(s),this[Ae].dynamicScope.push(n),this[Te]=new _n,this[Ee]=new jn(a,this[Me],e.program,{debugBefore:e=>Fs.debugBefore(this,e),debugAfter:e=>{Fs.debugAfter(this,e)}},a[Ne]),this.destructor={},this[Ce].push(this.destructor)}get stack(){return this[Ee].stack}get pc(){return this[Ee].fetchRegister(0)}fetch(e){this.stack.push(this.fetchValue(e))}load(e){let t=this.stack.pop();this.loadValue(e,t)}fetchValue(e){if(ke(e))return this[Ee].fetchRegister(e);switch(e){case 4:return this.s0;case 5:return this.s1;case 6:return this.t0;case 7:return this.t1;case 8:return this.v0}}loadValue(e,t){switch(ke(e)&&this[Ee].loadRegister(e,t),e){case 4:this.s0=t;break;case 5:this.s1=t;break;case 6:this.t0=t;break;case 7:this.t1=t;break;case 8:this.v0=t}}pushFrame(){this[Ee].pushFrame()}popFrame(){this[Ee].popFrame()}goto(e){this[Ee].goto(e)}call(e){this[Ee].call(e)}returnTo(e){this[Ee].returnTo(e)}return(){this[Ee].return()}get program(){return this.runtime.program}get env(){return this.runtime.env}captureState(e,t=this[Ee].fetchRegister(0)){return{pc:t,dynamicScope:this.dynamicScope(),scope:this.scope(),stack:this.stack.capture(e)}}beginCacheGroup(){this[Ae].cache.push(this.updating().tail())}commitCacheGroup(){let e=new hn("END"),t=this.updating(),s=this[Ae].cache.pop(),n=s?t.nextNode(s):t.head(),r=t.tail(),i=Ws(new ce(n,r)),a=new un(i,e);t.insertBefore(a,n),t.append(new cn(a)),t.append(e)}enter(e){let t=new ue,s=this.capture(e),n=this.elements().pushUpdatableBlock(),r=new $n(s,this.runtime,n,t);this.didEnter(r)}iterate(e,t){let s=this.stack;s.push(t),s.push(e);let n=this.capture(2),r=this.elements().pushUpdatableBlock();return new $n(n,this.runtime,r,new ue)}enterItem(e,t){this.listBlock().map.set(e,t),this.didEnter(t)}enterList(e){let t=new ue,s=this[Ee].target(e),n=this.capture(0,s),r=this.elements().pushBlockList(t),i=this.stack.peek().artifacts,a=new Jn(n,this.runtime,r,t,i);this[Ae].list.push(a),this.didEnter(a)}didEnter(e){this.associateDestructor(ne(e)),this[Ce].push(e),this.updateWith(e),this.pushUpdating(e.children)}exit(){this[Ce].pop(),this.elements().popBlock(),this.popUpdating(),this.updating().tail().didInitializeChildren()}exitList(){this.exit(),this[Ae].list.pop()}pushUpdating(e=new ue){this[Ae].updating.push(e)}popUpdating(){return this[Ae].updating.pop()}updateWith(e){this.updating().append(e)}listBlock(){return this[Ae].list.current}associateDestructor(e){if(!Z(e))return;ee(this[Ce].current,e)}associateDestroyable(e){this.associateDestructor(ne(e))}tryUpdating(){return this[Ae].updating.current}updating(){return this[Ae].updating.current}elements(){return this.elementStack}scope(){return this[Ae].scope.current}dynamicScope(){return this[Ae].dynamicScope.current}pushChildScope(){this[Ae].scope.push(this.scope().child())}pushDynamicScope(){let e=this.dynamicScope().child();return this[Ae].dynamicScope.push(e),e}pushRootScope(e){let t=Ts.sized(e);return this[Ae].scope.push(t),t}pushScope(e){this[Ae].scope.push(e)}popScope(){this[Ae].scope.pop()}popDynamicScope(){this[Ae].dynamicScope.pop()}getSelf(){return this.scope().getSelf()}referenceForSymbol(e){return this.scope().getSymbol(e)}execute(e){let t;e&&e(this);try{for(;t=this.next(),!t.done;);}finally{let e=this.elements();for(;e.hasBlocks;)e.popBlock()}return t.value}next(){let e,{env:t,elementStack:s}=this,n=this[Ee].nextStatement();return null!==n?(this[Ee].evaluateOuter(n,this),e={done:!1,value:null}):(this.stack.reset(),e={done:!0,value:new Yn(t,this.popUpdating(),s.popBlock(),this.destructor)}),e}bindDynamicScope(e){let t=this.dynamicScope();for(let s=e.length-1;s>=0;s--){let n=this[_e].getString(e[s]);t.set(n,this.stack.pop())}}}function tr(e,t=Ts.root(Bt,0),s){return{pc:e,scope:t,dynamicScope:s,stack:[]}}Xn=Ae,Zn=Ce;function sr(e){return(t,s,n)=>new nr(t,s,n,e)}class nr extends er{constructor(e,t,s,n){super(e,t,s),this.context=n,this.resume=sr(this.context)}static initial(e,t,{handle:s,self:n,dynamicScope:r,treeBuilder:i}){let a=e.program.heap.scopesizeof(s),l=Ts.root(n,a),o=tr(e.program.heap.getaddr(s),l,r),u=sr(t)(e,o,i);return u.pushUpdating(),u}static empty(e,{handle:t,treeBuilder:s,dynamicScope:n},r){let i=sr(r)(e,tr(e.program.heap.getaddr(t),Ts.root(Bt,0),n),s);return i.pushUpdating(),i}capture(e,t=this[Ee].fetchRegister(0)){return new Fn(this.captureState(e,t),this.resume)}compile(e){return ye(e.compile(this.context))}}class rr{constructor(e){this.vm=e}next(){return this.vm.next()}sync(){return function(e,t){let s;e.begin();do{s=t.next()}while(!s.done);let n=s.value;return e.commit(),n}(this.vm.runtime.env,this)}}function ir(e,t,s,n){const r=Object.keys(n).map(e=>[e,n[e]]),i=["main","else","attrs"],a=r.map(([e])=>"@"+e);e.pushFrame();for(let t=0;t<3*i.length;t++)e.stack.push(null);return e.stack.push(null),r.forEach(([,t])=>{e.stack.push(t)}),e[Te].setup(e.stack,a,i,0,!0),e.stack.push(e[Te]),e.stack.push(t),e.stack.push(s),new rr(e)}function ar(e){return{type:"array",value:e}}function lr(e){return{type:"string-array",value:e}}function or(e){return{type:"template-meta",value:e}}function ur(e){return{type:"other",value:e}}function cr(e){return{type:"label",value:e}}function hr(e,t){return{type:"primitive",value:{primitive:e,type:t}}}const pr={dynamicLayout:!1,dynamicTag:!1,prepareArgs:!1,createArgs:!1,attributeHook:!1,elementHook:!1,dynamicScope:!1,createCaller:!1,updateHook:!1,createInstance:!1,wrapped:!1,willDestroy:!1};class dr{constructor(e){this.inner=e}lookupHelper(e,t){if(this.inner.lookupHelper){let s=this.inner.lookupHelper(e,t);if(void 0===s)throw new Error(`Unexpected helper (${e} from ${JSON.stringify(t)}) (lookupHelper returned undefined)`);return s}throw new Error("Can't compile global helper invocations without an implementation of lookupHelper")}lookupModifier(e,t){if(this.inner.lookupModifier){let s=this.inner.lookupModifier(e,t);if(void 0===s)throw new Error(`Unexpected modifier (${e} from ${JSON.stringify(t)}) (lookupModifier returned undefined)`);return s}throw new Error("Can't compile global modifier invocations without an implementation of lookupModifier")}lookupComponent(e,t){if(this.inner.lookupComponent){let s=this.inner.lookupComponent(e,t);if(void 0===s)throw new Error(`Unexpected component (${e} from ${JSON.stringify(t)}) (lookupComponent returned undefined)`);return s}throw new Error("Can't compile global component invocations without an implementation of lookupComponent")}lookupPartial(e,t){if(this.inner.lookupPartial){let s=this.inner.lookupPartial(e,t);if(void 0===s)throw new Error(`Unexpected partial (${e} from ${JSON.stringify(t)}) (lookupPartial returned undefined)`);return s}throw new Error("Can't compile global partial invocations without an implementation of lookupPartial")}resolve(e){if(this.inner.resolve)return this.inner.resolve(e);throw new Error("Compile-time debugging requires an implementation of resolve")}}function mr(e,{resolver:t,meta:{referrer:s}}){let n=t.lookupComponent(e,s);if(null===n)return n;let{handle:r,compilable:i,capabilities:a}=n;return{handle:r,compilable:i,capabilities:a||pr}}class fr{constructor(e){this.buffer=e,this.size=0}encode(e,t){if(e>255)throw new Error(`Opcode type over 8-bits. Got ${e}.`);let s=e|t|arguments.length-2<<8;this.buffer.push(s);for(let e=2;e<arguments.length;e++){let t=arguments[e];if("number"==typeof t&&t>2147483647)throw new Error(`Operand over 32-bits. Got ${t}.`);this.buffer.push(t)}this.size=this.buffer.length}patch(e,t){if(-1!==this.buffer[e+1])throw new Error("Trying to patch operand in populated slot instead of a reserved slot.");this.buffer[e+1]=t}}function gr(e){return[br(e),si(31)]}function br(e){let t;switch(typeof e){case"number":t=me(e)?hr(e,0):hr(e,2);break;case"string":t=hr(e,1);break;case"boolean":case"object":case"undefined":t=hr(e,0);break;default:throw new Error("Invalid primitive passed to pushPrimitive")}return si(30,t)}function yr({handle:e,params:t,hash:s}){return[si(0),si("SimpleArgs",{params:t,hash:s,atNames:!1}),si(16,e),si(1),si(36,8)]}function vr(e,t){return[si(59),si(58,lr(e)),t(),si(60)]}function wr(e,t){return[si("SimpleArgs",{params:t,hash:null,atNames:!0}),si(24,e),si(25),si("Option",si("JitCompileBlock")),si(64),si(40),si(1)]}function kr(e){return[Er(e&&e.symbolTable),si(62),si("PushCompilable",e)]}function xr(e){return[si(0),si("PushCompilable",e),si("JitCompileBlock"),si(2),si(1)]}function Sr(e,t){let{parameters:s}=e.symbolTable,n=s.length,r=Math.min(t,n);if(0===r)return xr(e);let i=[];if(i.push(si(0)),r){i.push(si(39));for(let e=0;e<r;e++)i.push(si(33,2,t-e)),i.push(si(19,s[e]))}return i.push(si("PushCompilable",e)),i.push(si("JitCompileBlock")),i.push(si(2)),r&&i.push(si(40)),i.push(si(1)),i}function Er(e){return e?si(63,{type:"serializable",value:e}):br(null)}function Cr(e){let t=[],s=0;e((function(e,n){t.push({match:e,callback:n,label:"CLAUSE"+s++})}));let n=[si(69,2),si(68),si(32),si("StartLabels")];for(let e of t.slice(0,-1))n.push(si(67,cr(e.label),e.match));for(let e=t.length-1;e>=0;e--){let s=t[e];n.push(si("Label",s.label),si(34,2),s.callback()),0!==e&&n.push(si(4,cr("END")))}return n.push(si("Label","END"),si("StopLabels"),si(70)),n}function Ar({args:e,body:t}){let{count:s,actions:n}=e();return[si("StartLabels"),si(0),si(6,cr("ENDINITIAL")),n,si(69,s),t(),si("Label","FINALLY"),si(70),si(5),si("Label","ENDINITIAL"),si(1),si("StopLabels")]}function Nr({args:e,ifTrue:t,ifFalse:s}){return Ar({args:e,body:()=>{let e=[si(66,cr("ELSE")),t(),si(4,cr("FINALLY")),si("Label","ELSE")];return s&&e.push(s()),e}})}function Mr(e,t){let{encoder:s,syntax:{program:{mode:n,constants:r}}}=e;switch(t.op){case"Option":return zr(e,function(e){let t=e.op1;return null===t?Lr:t}(t));case"Label":return s.label(t.op1);case"StartLabels":return s.startLabels();case"StopLabels":return s.stopLabels();case"JitCompileBlock":return zr(e,function(e){return"jit"===e?si(61):Lr}(n));case"GetComponentLayout":return s.push(r,function(e){return"aot"===e?94:95}(n),t.op1);case"SetBlock":return s.push(r,function(e){return"aot"===e?20:21}(n),t.op1);default:return V(t)}}function _r(e,t){jr(e,function(e,t){switch(t.op){case"CompileBlock":return function(e,t){return function(e,t){let[,s,n,r,i]=e,a=Zr(i,t.meta),l=Qr(s,t.meta,"Expected block head to be a string");if("string"!=typeof l)return l;return t.syntax.macros.blocks.compile(l,n||[],r,a,t)}(t.op1,e)}(e,t);case"CompileInline":return function(e,t){let{inline:s,ifUnhandled:n}=t.op1,r=function(e,t){return t.syntax.macros.inlines.compile(e,t)}(s,e);return Ir(r)?r:n(s)}(e,t);case"InvokeStatic":return function(e,t){let s=t.op1;if("aot"===e.program.mode){let t=s.compile(e);return"number"!=typeof t?si("Error",{problem:"Invalid block",start:0,end:0}):si(3,t===Jr?()=>s.compile(e):t)}return[si(29,ur(t.op1)),si(61),si(2)]}(e.syntax,t);case"Args":return function({params:e,hash:t,blocks:s,atNames:n}){let r=[],i=s.names;for(let e=0;e<i.length;e++)r.push(kr(s.get(i[e])));let{count:a,actions:l}=ri(e);r.push(l);let o=a<<4;n&&(o|=8);s&&(o|=7);let u=B;if(t){u=t[0];let e=t[1];for(let t=0;t<e.length;t++)r.push(si("Expr",e[t]))}return r.push(si(84,lr(u),lr(i),o)),r}(t.op1);case"PushCompilable":return function(e,t){if(null===e)return br(null);if("aot"===t.program.mode){let s=e.compile(t);return"number"!=typeof s?si("Error",{problem:"Compile Error (TODO: thread better)",start:0,end:0}):br(s)}return si(29,ur(e))}(t.op1,e.syntax);case"DynamicComponent":return function(e,t){let{definition:s,attrs:n,params:r,args:i,blocks:a,atNames:l}=t.op1,o=n&&n.length>0?Kr(n,e.meta):null,u=Array.isArray(a)||null===a?Zr(a,e.meta):a;return ui(e.meta,{definition:s,attrs:o,params:r,hash:i,atNames:l,blocks:u})}(e,t);case"IfResolvedComponent":return function(e,t){let{name:s,attrs:n,blocks:r,staticTemplate:i,dynamicTemplate:a,orElse:l}=t.op1,o=mr(s,{resolver:e.syntax.program.resolverDelegate,meta:e.meta}),{meta:u}=e;if(null!==o){let{handle:e,capabilities:t,compilable:s}=o,l=Kr(n,u),c=Zr(r,u);return null!==s?i(e,t,s,{attrs:l,blocks:c}):a(e,t,{attrs:l,blocks:c})}if(l)return l();throw new Error("Compile Error: Cannot find component "+s)}(e,t);default:return V(t)}}(e,t))}function Tr(e,t,s){void 0!==s.op3?e.push(t,s.op,s.op1,s.op2,s.op3):void 0!==s.op2?e.push(t,s.op,s.op1,s.op2):void 0!==s.op1?e.push(t,s.op,s.op1):e.push(t,s.op)}class Rr{constructor(){this.names={},this.funcs=[]}add(e,t){this.names[e]=this.funcs.push(t)-1}compile(e,t){let s=e[0],n=this.names[s];return(0,this.funcs[n])(e,t)}}const Or=new Rr;function Pr(e,t,s,n){switch(s.op){case"SimpleArgs":Ur(e,t,function(e,t,s){let n=[],{count:r,actions:i}=ri(e);n.push(i);let a=r<<4;s&&(a|=8);let l=B;if(t){l=t[0];let e=t[1];for(let t=0;t<e.length;t++)n.push(si("Expr",e[t]))}return n.push(si(84,lr(l),lr(B),a)),n}(s.op1.params,s.op1.hash,s.op1.atNames),n);break;case"Expr":Ur(e,t,(r=s.op1,i=t.meta,Array.isArray(r)?Or.compile(r,i):[br(r),si(31)]),n);break;case"IfResolved":Ur(e,t,function(e,{op1:t}){let{kind:s,name:n,andThen:r,orElse:i,span:a}=t,l=function(e,t,s,n){switch(t){case"Modifier":return e.lookupModifier(s,n);case"Helper":return e.lookupHelper(s,n);case"ComponentDefinition":{let t=e.lookupComponent(s,n);return t&&t.handle}}}(e.syntax.program.resolverDelegate,s,n,e.meta.referrer);return null!==l?r(l):i?i():ti(`Unexpected ${s} ${n}`,a.start,a.end)}(t,s),n);break;case"ResolveFree":throw new Error("Unimplemented HighLevelResolutionOpcode.ResolveFree");case"ResolveContextualFree":{let{freeVar:r,context:i}=s.op1;if(t.meta.asPartial){Ur(e,t,[si(105,t.meta.upvars[r])],n);break}switch(i){case"Expression":{let s=t.meta.upvars[r];Ur(e,t,[si(22,0),si(23,s)],n);break}case"AppendSingleId":{let s,i=t.syntax.program.resolverDelegate,a=t.meta.upvars[r],l=i.lookupHelper(a,t.meta.referrer);s=l?yr({handle:l,params:null,hash:null}):[si(22,0),si(23,a)],Ur(e,t,s,n);break}default:throw new Error("unimplemented: Can't evaluate expression in context "+i)}break}default:return V(s)}var r,i}Or.add(32,([,e])=>{let t=[];for(let s of e)t.push(si("Expr",s));return t.push(si(28,e.length)),t}),Or.add(31,([,e,t,s,n,r],i)=>{if(function(e,t){if(!Array.isArray(e))return!1;if(27===e[0]){let s=e[1];return!(26!==s[0]||!t.upvars||"component"!==t.upvars[s[1]])}return!1}(s,i)){if(!n||0===n.length)return si("Error",{problem:"component helper requires at least one argument",start:e,end:e+t});let[s,...a]=n;return function({definition:e,params:t,hash:s,atNames:n},r){return[si(0),si("SimpleArgs",{params:t,hash:s,atNames:n}),si(88),si("Expr",e),si(79,or(r)),si(1),si(36,8)]}({definition:s,params:a,hash:r,atNames:!1},i.referrer)}let a=Qr(s,i,"Expected call head to be a string");return"string"!=typeof a?a:si("IfResolved",{kind:"Helper",name:a,andThen:e=>yr({handle:e,params:n,hash:r}),span:{start:e,end:e+t}})}),Or.add(24,([,e])=>[si(22,e)]),Or.add(27,([,e,t])=>[si("Expr",e),...t.map(e=>si(23,e))]),Or.add(25,([,e])=>si("ResolveFree",e)),Or.add(26,([,e,t])=>si("ResolveContextualFree",{freeVar:e,context:t})),Or.add(30,()=>gr(void 0)),Or.add(28,([,e])=>[si("Expr",e),si(26)]),Or.add(29,([,e])=>[si("Expr",e),si(25),si("JitCompileBlock"),si(27)]);const Lr={"no-action":!0},Br={"not-handled":!0};function Dr(e){return e&&!!e["no-action"]}function Ir(e){return!e||!e["not-handled"]}function zr(e,t){if(!Dr(t))if(Array.isArray(t))for(let s of t)zr(e,s);else"Simple"===t.type?Mr(e,t):Tr(e.encoder,e.syntax.program.constants,t)}function Ur(e,t,s,n){if(!Dr(s))if(Array.isArray(s))for(let r of s)Ur(e,t,r,n);else if("Number"===s.type)Tr(e,n,s);else if("Resolution"===s.type)Pr(e,t,s,n);else if("Simple"===s.type)Mr(t,s);else{if("Error"!==s.type)throw we(s,"unexpected action kind");e.error({problem:s.op1.problem,span:{start:s.op1.start,end:s.op1.end}})}}function jr(e,t){if(!Dr(t))if(Array.isArray(t))for(let s of t)jr(e,s);else if("Number"===t.type)Tr(e.encoder,e.syntax.program.constants,t);else if("Compile"===t.type)_r(e,t);else if("Resolution"===t.type)Pr(e.encoder,e,t,e.syntax.program.constants);else if("Simple"===t.type)Mr(e,t);else if("Error"!==t.type)throw we(t,"unexpected action type")}class Hr{constructor(){let{blocks:e,inlines:t}=function(e,t){return e.add("if",(e,t,s)=>{if(!e||1!==e.length)throw new Error("SYNTAX ERROR: #if requires a single argument");return Nr({args:()=>({count:1,actions:[si("Expr",e[0]),si(71)]}),ifTrue:()=>xr(s.get("default")),ifFalse:()=>s.has("else")?xr(s.get("else")):Lr})}),e.add("unless",(e,t,s)=>{if(!e||1!==e.length)throw new Error("SYNTAX ERROR: #unless requires a single argument");return Nr({args:()=>({count:1,actions:[si("Expr",e[0]),si(71)]}),ifTrue:()=>s.has("else")?xr(s.get("else")):Lr,ifFalse:()=>xr(s.get("default"))})}),e.add("with",(e,t,s)=>{if(!e||1!==e.length)throw new Error("SYNTAX ERROR: #with requires a single argument");return Nr({args:()=>({count:2,actions:[si("Expr",e[0]),si(33,3,0),si(71)]}),ifTrue:()=>Sr(s.get("default"),1),ifFalse:()=>s.has("else")?xr(s.get("else")):Lr})}),e.add("let",(e,t,s)=>{if(!e)return ti("let requires arguments",0,0);let{count:n,actions:r}=ri(e);return[r,Sr(s.get("default"),n)]}),e.add("each",(e,t,s)=>Ar({args(){let s;return s=t&&"key"===t[0][0]?[si("Expr",t[1][0])]:[gr(null)],s.push(si("Expr",e[0])),{count:2,actions:s}},body(){let e=[si(74),si(66,cr("ELSE")),si(0),si(33,2,1),si(6,cr("ITER")),si(72,cr("BODY")),si("Label","ITER"),si(75,cr("BREAK")),si("Label","BODY"),Sr(s.get("default"),2),si(34,2),si(4,cr("FINALLY")),si("Label","BREAK"),si(73),si(1),si(4,cr("FINALLY")),si("Label","ELSE")];return s.has("else")&&e.push(xr(s.get("else"))),e}})),e.add("in-element",(e,t,s)=>{if(!e||1!==e.length)throw new Error("SYNTAX ERROR: #in-element requires a single argument");return Nr({args(){let[s,n]=t,r=[];for(let e=0;e<s.length;e++){let t=s[e];if("guid"!==t&&"insertBefore"!==t)throw new Error(`SYNTAX ERROR: #in-element does not take a \`${s[0]}\` option`);r.push(si("Expr",n[e]))}return r.push(si("Expr",e[0]),si(33,3,0)),{count:4,actions:r}},ifTrue:()=>[si(50),xr(s.get("default")),si(56)]})}),e.add("-with-dynamic-vars",(e,t,s)=>{if(t){let[e,n]=t,{actions:r}=ri(n);return[r,vr(e,()=>xr(s.get("default")))]}return xr(s.get("default"))}),e.add("component",(e,t,s,n)=>{if("string"==typeof e[0]){let r=li(n,e[0],t,s.get("default"));if(Ir(r))return r}let[r,...i]=e;return si("DynamicComponent",{definition:r,attrs:null,params:i,args:t,atNames:!1,blocks:s})}),t.add("component",(e,t,s,n)=>{let r=t&&t[0];if("string"==typeof r){let e=li(n,r,s,null);if(e!==Br)return e}let[i,...a]=t;return ui(n.meta,{definition:i,attrs:null,params:a,hash:s,atNames:!1,blocks:Xr})}),{blocks:e,inlines:t}}(new Fr,new Vr);this.blocks=e,this.inlines=t}}class Fr{constructor(){this.names=U(),this.funcs=[]}add(e,t){this.funcs.push(t),this.names[e]=this.funcs.length-1}addMissing(e){this.missing=e}compile(e,t,s,n,r){let i=this.names[e],a={resolver:r.syntax.program.resolverDelegate,meta:r.meta};if(void 0===i){return(0,this.missing)(e,t,s,n,a)}return(0,this.funcs[i])(t,s,n,a)}}class Vr{constructor(){this.names=U(),this.funcs=[]}add(e,t){this.funcs.push(t),this.names[e]=this.funcs.length-1}addMissing(e){this.missing=e}compile(e,t){let s,n,r,[,,,,i]=e;if(!Array.isArray(i))return Br;if(31===i[0]){let e=Qr(i[3],t.meta,"Expected head of call to be a string");if("string"!=typeof e)return e;s=e,n=i[4],r=i[5]}else{if(27!==i[0])return Br;{let e=function([,e,t],s){if(t.length>0)return null;if(25===e[0]||26===e[0])return s.upvars[e[1]];return null}(i,t.meta);if(null===e)return Br;s=e,n=null,r=null}}let a=this.names[s],l={resolver:t.syntax.program.resolverDelegate,meta:t.meta};if(void 0===a&&this.missing){return(0,this.missing)(s,n,r,l)}if(void 0!==a){return(0,this.funcs[a])(s,n,r,l)}return Br}}function $r(e,t){return{syntax:e,encoder:new ni,meta:t}}const Wr=new Rr;Wr.add(2,e=>si(42,e[1])),Wr.add(11,()=>si(55)),Wr.add(10,()=>si(54)),Wr.add(3,(e,t)=>{let[,,,s,n,r]=e,i=Qr(s,t,"Expected modifier head to be a string");return"string"!=typeof i?i:si("IfResolved",{kind:"Modifier",name:i,andThen:e=>[si(0),si("SimpleArgs",{params:n,hash:r,atNames:!1}),si(57,e),si(1)],span:{start:0,end:0}})}),Wr.add(12,([,e,t,s])=>si(51,e,t,s)),Wr.add(23,([,e,t,s])=>si(108,e,t,s)),Wr.add(13,([,e,t,s])=>[si("Expr",t),si(52,e,!1,s)]),Wr.add(20,([,e,t,s])=>[si("Expr",t),si(52,e,!0,s)]),Wr.add(14,([,e,t,s])=>[si("Expr",t),si(53,e,!1,s)]),Wr.add(21,([,e,t,s])=>[si("Expr",t),si(53,e,!0,s)]),Wr.add(9,([,e,t])=>t?si(48,e):[si(91),si(48,e)]),Wr.add(7,([,e,t,s,n])=>"string"==typeof e?si("IfResolvedComponent",{name:e,attrs:t,blocks:n,staticTemplate:(e,t,n,{blocks:r,attrs:i})=>[si(80,e),oi({capabilities:t,layout:n,attrs:i,params:null,hash:s,blocks:r})],dynamicTemplate:(e,t,{attrs:n,blocks:r})=>[si(80,e),ci({capabilities:t,attrs:n,params:null,hash:s,atNames:!0,blocks:r})]}):si("DynamicComponent",{definition:e,attrs:t,params:null,args:s,blocks:n,atNames:!0})),Wr.add(17,([,e,t],s)=>Nr({args:()=>({count:2,actions:[si("Expr",e),si(33,3,0)]}),ifTrue:()=>[si(104,or(s.referrer),lr(s.evalSymbols),ar(t)),si(40),si(1)]})),Wr.add(16,([,e,t])=>wr(e,t)),Wr.add(15,([,e])=>wr(e,B)),Wr.add(22,([,e],t)=>si(106,lr(t.evalSymbols),ar(e))),Wr.add(1,e=>{let[,t,,,s]=e;return"string"==typeof s&&t?si(41,s):si("CompileInline",{inline:e,ifUnhandled:()=>[si(0),si("Expr",s),si(3,{type:"stdlib",value:t?"trusting-append":"cautious-append"}),si(1)]})}),Wr.add(5,e=>si("CompileBlock",e));const Jr=-1;class Gr{constructor(e,t,s){this.statements=e,this.meta=t,this.symbolTable=s,this.compiled=null}compile(e){return function(e,t){if(null!==e.compiled)return e.compiled;e.compiled=Jr;let{statements:s,meta:n}=e,r=function(e,t,s){let n=Wr,r=$r(s,t);for(let t=0;t<e.length;t++)jr(r,n.compile(e[t],r.meta));0;return r.encoder.commit(s.program.heap,t.size)}(s,n,t);return Ms(t.program),e.compiled=r,r}(this,e)}}function Yr(e){let t=e.block;return new Gr(t.statements,ii(e),{symbols:t.symbols,hasEval:t.hasEval})}function Kr(e,t){let s=Array.isArray(e)?{statements:e,parameters:B}:e;return new Gr(s.statements,t,{parameters:s.parameters})}class qr{constructor(e){this.blocks=e,this.names=e?Object.keys(e):[]}get(e){return this.blocks&&this.blocks[e]||null}has(e){let{blocks:t}=this;return null!==t&&e in t}with(e,t){let{blocks:s}=this;return new qr(s?pe({},s,{[e]:t}):{[e]:t})}get hasAny(){return null!==this.blocks}}const Xr=new qr(null);function Zr(e,t){if(null===e)return Xr;let s=U(),[n,r]=e;for(let e=0;e<n.length;e++)s[n[e]]=Kr(r[e],t);return new qr(s)}function Qr(e,t,s){if(!t.upvars)return ti(s+", but there were no free variables in the template",0,0);if(!Array.isArray(e)||27!==e[0])throw new Error(`${s}, got ${JSON.stringify(e)}`);if(0!==e[2].length)throw new Error(`${s}, got ${JSON.stringify(e)}`);if(26===e[1][0]||25===e[1][0]){let s=e[1][1];return t.upvars[s]}throw new Error(`${s}, got ${JSON.stringify(e)}`)}class ei{constructor(){this.labels=U(),this.targets=[]}label(e,t){this.labels[e]=t}target(e,t){this.targets.push({at:e,target:t})}patch(e){let{targets:t,labels:s}=this;for(let n=0;n<t.length;n++){let{at:r,target:i}=t[n],a=s[i]-r;e.patch(r,a)}}}function ti(e,t,s){return si("Error",{problem:e,start:t,end:s})}function si(e,t,s,n){if("number"==typeof e)return void 0!==n?{type:"Number",op:e,op1:t,op2:s,op3:n}:void 0!==s?{type:"Number",op:e,op1:t,op2:s}:void 0!==t?{type:"Number",op:e,op1:t}:{type:"Number",op:e};{let s;if("CompileInline"===(r=e)||"CompileBlock"===r||"InvokeStatic"===r||"PushCompilable"===r||"Args"===r||"IfResolvedComponent"===r||"DynamicComponent"===r)s="Compile";else if(function(e){return"IfResolved"===e||"Expr"===e||"SimpleArgs"===e||"ResolveFree"===e||"ResolveContextualFree"===e}(e))s="Resolution";else if(function(e){return"Label"===e||"Option"===e||"GetComponentLayout"===e||"StartLabels"===e||"StopLabels"===e||"SimpleArgs"===e||"JitCompileBlock"===e||"SetBlock"===e}(e))s="Simple";else{if(!function(e){return"Error"===e}(e))throw new Error("Exhausted "+e);s="Error"}return void 0===t?{type:s,op:e,op1:void 0}:{type:s,op:e,op1:t}}var r}class ni{constructor(){this.labelsStack=new H,this.encoder=new fr([]),this.errors=[]}error(e){this.encoder.encode(30,0),this.errors.push(e)}commit(e,t){this.encoder.encode(5,1024);let s=function(e,t,s){let n=e.malloc();for(let t=0;t<s.length;t++){let n=s[t];"function"==typeof n?e.pushPlaceholder(n):"object"==typeof n?e.pushStdlib(n):e.push(n)}return e.finishMalloc(n,t),n}(e,t,this.encoder.buffer);return this.errors.length?{errors:this.errors,handle:s}:s}push(e,t,...s){if((n=t)>=0&&n<=15){let n=s.map((t,s)=>this.operand(e,t,s));return this.encoder.encode(t,1024,...n)}{let n=s.map((t,s)=>this.operand(e,t,s));return this.encoder.encode(t,0,...n)}var n}operand(e,t,s){return t&&"object"==typeof t&&"label"===t.type?(this.currentLabels.target(this.encoder.size+s,t.value),-1):function(e,t){if("number"==typeof t||"function"==typeof t)return t;if("boolean"==typeof t)return!0===t?1:0;if("string"==typeof t)return e.string(t);if(null===t)return 0;switch(t.type){case"array":return e.array(t.value);case"string-array":return e.stringArray(t.value);case"serializable":return e.serializable(t.value);case"template-meta":return e.templateMeta(t.value);case"other":return e.other(t.value);case"stdlib":return t;case"primitive":switch(t.value.type){case 1:return ge(e.string(t.value.primitive),1073741823,-1);case 2:return ge(e.number(t.value.primitive),1073741823,-1073741825);case 0:return de(t.value.primitive);default:return V(t.value)}case"lookup":throw F("lookup not reachable");default:return V(t)}}(e,t)}get currentLabels(){return this.labelsStack.current}label(e){this.currentLabels.label(e,this.encoder.size)}startLabels(){this.labelsStack.push(new ei)}stopLabels(){this.labelsStack.pop().patch(this.encoder)}}function ri(e){if(!e)return{count:0,actions:Lr};let t=[];for(let s=0;s<e.length;s++)t.push(si("Expr",e[s]));return{count:e.length,actions:t}}function ii(e){return{asPartial:e.asPartial||!1,evalSymbols:ai(e),upvars:e.block.upvars,referrer:e.referrer,size:e.block.symbols.length}}function ai(e){let{block:t}=e;return t.hasEval?t.symbols:null}function li(e,t,s,n){let r=mr(t,e);if(null!==r){let{compilable:e,handle:t,capabilities:i}=r;if(e){if(s)for(let e=0;e<s.length;e+=2)s[e][0]="@"+s[e][0];let r=[si(80,t)];return r.push(oi({capabilities:i,layout:e,attrs:null,params:null,hash:s,blocks:new qr({default:n})})),r}}return Br}function oi({capabilities:e,layout:t,attrs:s,params:n,hash:r,blocks:i}){let{symbolTable:a}=t;if(a.hasEval||e.prepareArgs)return ci({capabilities:e,attrs:s,params:n,hash:r,atNames:!0,blocks:i,layout:t});let l=[si(36,4),si(33,3,1),si(35,4)],{symbols:o}=a;e.createArgs&&l.push(si(0),si("SimpleArgs",{params:n,hash:r,atNames:!0})),l.push(si(100)),e.dynamicScope&&l.push(si(59)),e.createInstance&&l.push(si(89,0|i.has("default"),4)),e.createArgs&&l.push(si(1)),l.push(si(0),si(90,4));let u=[];l.push(si(92,4)),u.push({symbol:0,isBlock:!1});for(let e=0;e<o.length;e++){let t=o[e];switch(t.charAt(0)){case"&":let n;n="&attrs"===t?s:i.get(t.slice(1)),n?(l.push(kr(n)),u.push({symbol:e+1,isBlock:!0})):(l.push(kr(null)),u.push({symbol:e+1,isBlock:!0}));break;case"@":if(!r)break;let[a,o]=r,c=t,h=a.indexOf(c);-1!==h&&(l.push(si("Expr",o[h])),u.push({symbol:e+1,isBlock:!1}))}}l.push(si(37,o.length+1,Object.keys(i).length>0?1:0));for(let e=u.length-1;e>=0;e--){let{symbol:t,isBlock:s}=u[e];s?l.push(si("SetBlock",t)):l.push(si(19,t))}return l.push(si("InvokeStatic",t)),e.createInstance&&l.push(si(103,4)),l.push(si(1),si(40)),e.dynamicScope&&l.push(si(60)),l.push(si(101),si(35,4)),l}function ui(e,{definition:t,attrs:s,params:n,hash:r,atNames:i,blocks:a}){return Ar({args:()=>({count:2,actions:[si("Expr",t),si(33,3,0)]}),body:()=>[si(66,cr("ELSE")),si(83,or(e.referrer)),si(81),ci({capabilities:!0,attrs:s,params:n,hash:r,atNames:i,blocks:a}),si("Label","ELSE")]})}function ci({capabilities:e,attrs:t,params:s,hash:n,atNames:r,blocks:i,layout:a}){let l=!!i,o=!0===e||e.prepareArgs||!(!n||0===n[0].length),u=i.with("attrs",t);return[si(36,4),si(33,3,1),si(35,4),si(0),si("Args",{params:s,hash:n,blocks:u,atNames:r}),si(87,4),hi(u.has("default"),l,o,()=>{let e;return e=a?[Er(a.symbolTable),si("PushCompilable",a),si("JitCompileBlock")]:[si("GetComponentLayout",4)],e.push(si(98,4)),e}),si(35,4)]}function hi(e,t,s,n=null){let r=[si(100),si(59),si(89,0|e,4)];return n&&r.push(n()),r.push(si(90,4),si(92,4),si(38,4),si(19,0),si(97,4),s?si(17,4):Lr,t?si(18,4):Lr,si(34,1),si(99,4),si(103,4),si(1),si(40),si(60),si(101)),r}function pi(e){return Kr(e.block.statements,ii(e))}class di{constructor(e,t,s){this.main=e,this.trustingGuardedAppend=t,this.cautiousGuardedAppend=s}get"trusting-append"(){return this.trustingGuardedAppend}get"cautious-append"(){return this.cautiousGuardedAppend}getAppend(e){return e?this.trustingGuardedAppend:this.cautiousGuardedAppend}}function mi(){return[si(76,4),hi(!1,!1,!0)]}function fi(e){return[si(78),Cr(t=>{t(1,()=>e?[si(68),si(43)]:si(47)),t(0,()=>[si(82),si(81),[si(36,4),si(33,3,1),si(35,4),si(0),si(85),si(87,4),hi(!1,!1,!0,()=>[si("GetComponentLayout",4),si(98,4)]),si(35,4)]]),t(3,()=>[si(68),si(44)]),t(4,()=>[si(68),si(45)]),t(5,()=>[si(68),si(46)])})]}function gi(e){let t=yi(e,mi),s=yi(e,()=>fi(!0)),n=yi(e,()=>fi(!1));return new di(t,s,n)}const bi={asPartial:!1,evalSymbols:null,upvars:null,referrer:{},size:0};function yi(e,t){let s=new ni,n=new Hr;zr({encoder:s,meta:bi,syntax:{macros:n,program:e}},t());let r=s.commit(e.heap,0);if("number"!=typeof r)throw new Error("Unexpected errors compiling std");return r}class vi{constructor(e){this.constants=new ys,this.heap=new Ss,this.mode="jit",this.resolverDelegate=e,this.stdlib=gi(this)}}class wi{constructor(e){this.layout=e,this.compiled=null;let{block:t}=e,s=t.symbols.slice(),n=s.indexOf("&attrs");this.attrsBlockNumber=-1===n?s.push("&attrs"):n+1,this.symbolTable={hasEval:t.hasEval,symbols:s}}compile(e){if(null!==this.compiled)return this.compiled;let t=ii(this.layout),s=$r(e,t);var n,r,i,a;jr(s,(n=this.layout,r=this.attrsBlockNumber,[si("StartLabels"),(i=5,a=()=>[si(93,4),si(31),si(33,3,0)],[si(36,i),a(),si(35,i)]),si(66,cr("BODY")),si(36,5),si(91),si(49),si(102,4),wr(r,B),si(54),si("Label","BODY"),xr(pi(n)),si(36,5),si(66,cr("END")),si(55),si("Label","END"),si(35,5),si("StopLabels")]));let l=s.encoder.commit(s.syntax.program.heap,t.size);return"number"!=typeof l||(this.compiled=l,Ms(s.syntax.program)),l}}let ki=0;function xi({id:e,meta:t,block:s}){let n,r=e||"client-"+ki++;return{id:r,meta:t,create:e=>{let i=e?pe({},e,t):t;return n||(n=JSON.parse(s)),new Si({id:r,block:n,referrer:i})}}}class Si{constructor(e){this.parsedLayout=e,this.result="ok",this.layout=null,this.partial=null,this.wrappedLayout=null;let{block:t}=e;this.symbols=t.symbols,this.hasEval=t.hasEval,this.referrer=e.referrer,this.id=e.id||"client-"+ki++}asLayout(){return this.layout?this.layout:this.layout=Yr(pe({},this.parsedLayout,{asPartial:!1}))}asPartial(){return this.partial?this.partial:this.layout=Yr(pe({},this.parsedLayout,{asPartial:!0}))}asWrappedLayout(){return this.wrappedLayout?this.wrappedLayout:this.wrappedLayout=new wi(pe({},this.parsedLayout,{asPartial:!1}))}}function Ei(e){return Array.isArray(e)?0!==e.length:Boolean(e)}class Ci{constructor(){this.toBool=Ei}toIterator(e){return function(e){return"object"==typeof e&&null!==e&&Symbol.iterator in e}(e)?class{constructor(e,t){this.iterable=e,this.result=t,this.position=0}static from(e){const t=e[Symbol.iterator](),s=t.next(),{done:n}=s;return!0===n?null:new this(t,s)}isEmpty(){return!1}next(){const{iterable:e,result:t,position:s}=this;if(t.done)return null;const n=t.value,r=s;return this.position++,this.result=e.next(),{value:n,memo:r}}}.from(e):null}}class Ai extends Ci{constructor(){super(...arguments),this.isInteractive=!0,this.uselessAnchor=self.document.createElement("a"),this.protocolForURL=e=>(this.uselessAnchor.href=e,this.uselessAnchor.protocol)}}const Ni=new WeakMap,Mi=Object.getPrototypeOf;function _i(e,t){return Ni.set(t,e),t}const Ti=new WeakMap,Ri=`__OWNER_${Math.floor(Math.random()*Date.now())}__`;let Oi={};const Pi=new WeakMap,Li=new WeakMap,Bi=Object.getPrototypeOf;function Di(e,t){return Pi.set(t,e),t}function Ii(e){let t=e;for(;null!=t;){const e=Pi.get(t);if(void 0!==e)return e;t=Bi(t)}}function zi(e,t){let s=Li.get(e);void 0===s&&(s=new WeakMap,Li.set(e,s));let n=s.get(t);return void 0===n&&(n=t(e),s.set(t,n)),n}function Ui(e,t){const s=Ii(t);if(void 0!==s&&"component"===s.type)return zi(e,s.factory)}function ji(e){if("symbol"==typeof e)return null;const t=Number(e);return isNaN(t)?null:t%1==0?t:null}function Hi(e,t){const{named:s,positional:n}=e,r={get(e,t){if(s.has(t)){const e=s.get(t);return R(e.tag),e.value()}},has:(e,t)=>s.has(t),ownKeys:e=>s.names,isExtensible:()=>!1,getOwnPropertyDescriptor:(e,t)=>({enumerable:!0,configurable:!0})},i={get(e,t){if("length"===t)return R(n.tag),n.length;const s=ji(t);if(null!==s&&s<n.length){const e=n.at(s);return R(e.tag),e.value()}return e[t]},isExtensible:()=>!1,has(e,t){const s=ji(t);return null!==s&&s<n.length}},a=Object.create(null);return{named:new Proxy(a,r),positional:new Proxy([],i)}}const Fi={createInstance:!0,dynamicLayout:!1,dynamicTag:!1,wrapped:!1,prepareArgs:!1,createArgs:!0,attributeHook:!1,elementHook:!1,updateHook:!1,createCaller:!1,dynamicScope:!0,willDestroy:!1};function Vi(e){return e.capabilities.asyncLifecycleCallbacks}function $i(e){return e.capabilities.updateHook}function Wi(e){return e.capabilities.destructor}class Ji{constructor(e,t,s,n,r){this.env=e,this.delegate=t,this.component=s,this.args=n,this.argsProxy=r}destroy(){const{delegate:e,component:t}=this;Wi(e)&&e.destroyComponent(t)}}const Gi=new class{create(e,t,s,n){const{ComponentDefinition:r}=t,i=s.capture(),a=Ui(n.get(Ri).value(),r),l=Hi(i),o=a.createComponent(r,l);return new Ji(e,a,o,i,l)}update({delegate:e,component:t,argsProxy:s}){$i(e)&&e.updateComponent(t,s)}didCreate({delegate:e,component:t}){Vi(e)&&e.didCreateComponent(t)}didUpdate({delegate:e,component:t}){(function(e){return Vi(e)&&$i(e)})(e)&&e.didUpdateComponent(t)}getContext({delegate:e,component:t}){e.getContext(t)}getSelf({env:e,delegate:t,component:s}){return new lt(t.getContext(s),e)}getDestructor(e){return Wi(e.delegate)?e:null}getCapabilities({capabilities:e}){return Object.assign({},Fi,{updateHook:e.updateHook})}getTag({args:e}){return b(e)?m():e.tag}didRenderLayout(){}didUpdateLayout(){}getJitStaticLayout({definition:e}){return e.template.asLayout()}};class Yi{constructor(e,t,s){this.manager=Gi,this.handle=e,this.template=ve(s);const n=Ui(Oi,t).capabilities;this.state={ComponentDefinition:t,capabilities:n,definition:this}}}function Ki(e){let t,s,n;return()=>(s&&u(s,n)||(s=T(()=>t=e()),n=o()),R(s),t)}function qi(e){return(t,s)=>{const n=function(e,t){const s=Ii(t);if(void 0!==s&&"helper"===s.type)return zi(e,s.factory)}(s.dynamicScope().get(Ri).value(),e),r=t.capture();let i;if(void 0!==n)i=function(e,t,s,n){let r;const i=Hi(s),a=e.capabilities.updateHook;(function(e){return e.capabilities.destructor})(e)&&n.associateDestroyable({destroy(){void 0!==r&&e.destroyHelper(r)}});const l=Ki(()=>e.getValue(r)),o=Ki(()=>{void 0===r?r=e.createHelper(t,i):a&&e.updateHelper(r,i)});return()=>(o(),l())}(n,e,r,s);else{0;const t=e;i=e=>t(...e.positional.value())}return new ot(i,r,s.env)}}const Xi={attributeHook:!1,createArgs:!1,createCaller:!1,createInstance:!0,dynamicLayout:!1,dynamicScope:!1,dynamicTag:!1,elementHook:!1,prepareArgs:!1,updateHook:!1,wrapped:!1,willDestroy:!1};const Zi=new Ze(null);class Qi{static create(){return new Qi}getCapabilities(){return Xi}getJitStaticLayout({definition:e}){return e.template.asLayout()}create(e,t){}getSelf(e){return Zi}getTag(){return g}didRenderLayout(){}didCreate(){}didUpdateLayout(){}didUpdate(){}getDestructor(){return null}}const ea=new Qi;class ta{constructor(e,t,s){this.manager=ea,this.handle=e,this.template=ve(s),this.state={name:t,definition:this}}}class sa{}function na(e,t={}){return D("3.13"===e,"Invalid component manager compatibility specified"),{disableAutoTracking:Boolean(t.disableAutoTracking)}}const ra=new class{constructor(){this.capabilities=na("3.13")}createModifier(e,t){return{definition:e}}installModifier(e,t,s){e.destructor=e.definition(t,...s.positional),e.element=t}updateModifier(e,t){this.destroyModifier(e),this.installModifier(e,e.element,t)}destroyModifier(e){const{destructor:t}=e;void 0!==t&&t()}};class ia{constructor(e,t,s,n,r){this.element=e,this.delegate=t,this.modifier=s,this.argsProxy=n,this.capturedArgs=r,this.tag=f()}destroy(){const{delegate:e,modifier:t,argsProxy:s}=this;e.destroyModifier(t,s)}}const aa=new class{create(e,t,s,n){let r=function(e,t){const s=Ii(t);if(void 0!==s&&"modifier"===s.type)return zi(e,s.factory)}(n.get(Ri).value(),t);void 0===r&&(r=ra);const i=s.capture(),a=Hi(i),l=r.createModifier(t,a);return new ia(e,r,l,a,i)}getTag({tag:e,capturedArgs:t}){return v([e,t.tag])}install(e){const{element:t,argsProxy:s,delegate:n,modifier:r,tag:i}=e;if(!0===n.capabilities.disableAutoTracking)O(()=>n.installModifier(r,t,s));else{const e=T(()=>n.installModifier(r,t,s));d(i,e)}}update(e){const{argsProxy:t,delegate:s,modifier:n,tag:r}=e;if(!0===s.capabilities.disableAutoTracking)O(()=>s.updateModifier(n,t));else{const e=T(()=>s.updateModifier(n,t));d(r,e)}}getDestructor(e){return e}};class la{constructor(e,t){this.handle=e,this.state=t,this.manager=aa}}let oa=0;const ua=new WeakMap,ca=new WeakMap,ha=new WeakMap;function pa(e){return ua.get(e)||function(e){const t=xi(function(e){let t=e;for(;null!=t;){const e=Ni.get(t);if(void 0!==e)return e;t=Mi(t)}}(e)).create();let s;s=e instanceof sa?new ta(oa++,"template-only-component",t):new Yi(oa++,e,t);return ua.set(e,s),s}(e)}function da(e){return ca.get(e)||function(e){const t={helper:qi(e),handle:oa++};return ca.set(e,t),t}(e)}function ma(e){return ha.get(e)||function(e){const t=new la(oa++,e);return ha.set(e,t),t}(e)}const fa={if:(ga=function(e,t){return new ot(({positional:e})=>{if(e.length>3)throw new Error('The inline form of the `if` helper expects two or three arguments, e.g. `{{if trialExpired "Expired" expiryDate}}`.');const t=e.at(0),s=e.at(1),n=e.at(2);return!0===Ei(t.value())?s.value():void 0!==n?n.value():void 0},e.capture(),t.env,"if")},{helper:ga,handle:oa++})};var ga;let ba=[];var ya=async function(e,t){const s=t instanceof HTMLElement?{element:t}:t,{element:n,args:r,owner:i}=s,a=function(e,t,s,n,r={},i=Oi){const a=function(e,t={},s,n={}){return{env:new Ls(e,t),program:new Es(s.program.constants,s.program.heap),resolver:new Hs(n)}}(s,n,xa,ka),l=(u=a.env,c={element:t,nextSibling:null},$e.forInitialRender(u,c)),o=ka.registerRoot(e);var u,c;let h;i&&(h=new Mn({[Ri]:new Ze(i)}));return function(e,t,s,n,r,i={},a=new Mn){let l=nr.empty(e,{treeBuilder:t,handle:n,dynamicScope:a},s);const o=sn(l.runtime.resolver,r),{manager:u,state:c}=o;let h;if(!yn(Ks(u.getCapabilities(c))))throw new Error("Cannot invoke components with dynamic layouts as a root component.");{let e=u.getJitStaticLayout(c,l.runtime.resolver),t=ye(e.compile(s));if(Array.isArray(t)){let e=t[0];throw new Error(`Compile Error: ${e.problem} ${e.span.start}..${e.span.end} :: TODO (thread better)`)}h={handle:t,symbolTable:e.symbolTable}}return ir(l,h,o,i)}(a,l,xa,0,o,function(e,t){const s=new lt(e,t);return Object.keys(e).reduce((e,t)=>(e[t]=s.get(t),e),{})}(r,a.env),h)}(e,n,{document:self.document},new Ai,r,i).sync();va.push(a)};const va=[];k=function(){wa||(wa=!0,setTimeout(()=>{wa=!1;try{!function(){for(const e of va){const{env:t}=e;t.begin(),e.rerender(),t.commit()}}(),ba.forEach(([e])=>e())}catch(e){ba.forEach(([,t])=>t(e))}ba=[]},0))};let wa=!1;const ka=new class{constructor(){this.registry=[]}registerRoot(e){const t=pa(e),{handle:s}=t;return this.registry[s]=t,s}lookupComponent(e,t){return this.registry[e]}resolve(e){return this.registry[e]}compilable(e){throw new Error("Method not implemented.")}lookupPartial(e,t){throw new Error("Method not implemented.")}},xa=function(e={},t=new Hr){return{program:new vi(new dr(e)),macros:t}}(new class{constructor(e){this.inner=e}lookupHelper(e,t){const s=t.scope(),{helper:n,handle:r}=fa[e]||da(s[e]);return this.inner.registry[r]=n,r}lookupModifier(e,t){const s=ma(t.scope()[e]),{handle:n}=s;return this.inner.registry[n]=s,n}lookupComponent(e,t){const s=t.scope()[e];const n=pa(s),{state:r,manager:i,template:a,handle:l}=n;return this.inner.registry[l]=n,{handle:l,capabilities:i.getCapabilities(r),compilable:ve(a).asLayout()}}resolve(e){return this.inner.resolve(e)}lookupPartial(e,t){throw new Error("Method not implemented.")}}(ka));const Sa=new WeakMap,Ea=new WeakMap;const Ca=function(e,t={}){D("3.4"===e||"3.13"===e,"Invalid component manager compatibility specified");const s="3.4"===e||Boolean(t.updateHook);return{asyncLifecycleCallbacks:Boolean(t.asyncLifecycleCallbacks),destructor:Boolean(t.destructor),updateHook:s}}("3.13",{destructor:!0});class Aa extends class{constructor(e){this.owner=e}createComponent(e,t){return new e(this.owner,t.named)}getContext(e){return e}}{constructor(){super(...arguments),this.capabilities=Ca}destroyComponent(e){!function(e){Sa.set(e,!0)}(e),e.willDestroy(),function(e){Ea.set(e,!0)}(e)}}class Na extends class{constructor(e,t){this.args=t,Sa.set(this,!1),Ea.set(this,!1)}get isDestroying(){return Sa.get(this)||!1}get isDestroyed(){return Ea.get(this)||!1}willDestroy(){}}{constructor(e,t){super(e,t),function(e,t){Ti.set(e,t)}(this,e)}}Di({factory:e=>new Aa(e),type:"component"},Na);const Ma=(...e)=>{const[t,s,n]=e;if(n)return _a(t,s,n);Object.defineProperty(t,s,_a(t,s))};function _a(e,t,s){const{getter:n,setter:r}=L(t,s&&s.initializer);return{enumerable:!0,configurable:!0,get(){return n(this)},set(e){r(this,e)}}}function Ta(e,t,s,n){}class Ra{constructor(){this.capabilities=na("3.13")}createModifier(e,t){return{args:t,previousArgs:t}}installModifier(e,t){const{args:s}=e,[n,r]=s.positional,i=Object.assign({},s.named);t.addEventListener(n,r,i),e.element=t,e.previousArgs={positional:[n,r],named:i}}updateModifier(e){this.destroyModifier(e),this.installModifier(e,e.element)}destroyModifier({element:e,previousArgs:t}){const[s,n]=t.positional;e.removeEventListener(s,n,t.named)}}!function(e,t){Di({factory:e,type:"modifier"},t)}(()=>new Ra,Ta);const Oa=new WeakMap;function Pa(e,t,s){const n=s.value;return{enumerable:s.enumerable,configurable:s.configurable,get(){let e=Oa.get(this);void 0===e&&(e=new Map,Oa.set(this,e));let t=e.get(n);return void 0===t&&(t=n.bind(this),e.set(n,t)),t}}}var La;let Ba=_i({id:"NfHTuDcA",block:'{"symbols":["@item"],"statements":[[1,1,0,0,"\\n    "],[9,"a",false],[23,"href","javascript:;",null],[23,"class","",null],[3,0,0,[27,[26,0,"ModifierHead"],[]],["click",[27,[24,0],["selectFacet"]]],null],[10],[1,1,0,0,"\\n      "],[1,0,0,0,[27,[24,1],["value"]]],[1,1,0,0,"\\n      "],[9,"span",true],[12,"class","",null],[10],[1,1,0,0,"("],[1,0,0,0,[27,[24,1],["count"]]],[1,1,0,0,")"],[11],[1,1,0,0,"\\n    "],[11],[1,1,0,0,"\\n  "]],"hasEval":false,"upvars":["on"]}',meta:{scope:()=>({on:Ta})}},(Da=(La=class extends Na{selectFacet(){this.args.onClick(this.args.item)}}).prototype,Ia="selectFacet",za=[Pa],Ua=Object.getOwnPropertyDescriptor(La.prototype,"selectFacet"),ja=La.prototype,Ha={},Object.keys(Ua).forEach((function(e){Ha[e]=Ua[e]})),Ha.enumerable=!!Ha.enumerable,Ha.configurable=!!Ha.configurable,("value"in Ha||Ha.initializer)&&(Ha.writable=!0),Ha=za.slice().reverse().reduce((function(e,t){return t(Da,Ia,e)||e}),Ha),ja&&void 0!==Ha.initializer&&(Ha.value=Ha.initializer?Ha.initializer.call(ja):void 0,Ha.initializer=void 0),void 0===Ha.initializer&&(Object.defineProperty(Da,Ia,Ha),Ha=null),La));var Da,Ia,za,Ua,ja,Ha;class Fa extends Na{}_i({id:"CnXHb+ts",block:'{"symbols":["facet","item","@facetSelected","@facets"],"statements":[[1,1,0,0,"\\n    "],[9,"div",true],[12,"class","",null],[10],[1,1,0,0,"\\n"],[5,[27,[26,0,"BlockHead"],[]],[[27,[24,4],[]]],null,[["default"],[{"statements":[[1,1,0,0,"        "],[9,"div",true],[12,"class","border bg-white shadow my-4 p-4",null],[10],[1,1,0,0,"\\n          "],[9,"h3",true],[12,"class","text-lg font-bold",null],[10],[1,1,0,0,"\\n            "],[1,0,0,0,[27,[24,1],["key"]]],[1,1,0,0,"\\n          "],[11],[1,1,0,0,"\\n          "],[9,"ul",true],[12,"class","my-2 mx-4",null],[10],[1,1,0,0,"\\n"],[5,[27,[26,0,"BlockHead"],[]],[[27,[24,1],["items"]]],null,[["default"],[{"statements":[[1,1,0,0,"              "],[9,"li",true],[12,"class","",null],[10],[1,1,0,0,"\\n                "],[7,"FacetItem",[],[["@facet","@item","@onClick"],[[27,[24,1],[]],[27,[24,2],[]],[27,[24,3],[]]]],null],[1,1,0,0,"\\n              "],[11],[1,1,0,0,"\\n"]],"parameters":[2]}]]],[1,1,0,0,"          "],[11],[1,1,0,0,"\\n        "],[11],[1,1,0,0,"\\n"]],"parameters":[1]}]]],[1,1,0,0,"    "],[11],[1,1,0,0,"\\n  "]],"hasEval":false,"upvars":["each"]}',meta:{scope:()=>({FacetItem:Ba})}},Fa);class Va{constructor(e){this.owner=e,this.capabilities=function(e,t={}){return D("glimmerjs-2.0.0"===e,"Invalid helper manager compatibility specified"),{destructor:Boolean(t.destructor),updateHook:Boolean(t.updateHook)}}("glimmerjs-2.0.0")}getValue({fn:e,args:t,ownerProxy:s}){return e(t.positional,t.named,{services:s})}createHelper(e,t){const{owner:s}=this;return{fn:e,args:t,ownerProxy:new Proxy({},{get:(e,t)=>s.lookup({type:"service",name:t})})}}}const $a=e=>new Va(e);function Wa(e){return function(e,t){Di({factory:e,type:"helper"},t)}($a,e),e}function Ja(e,...t){return e.bind(null,...t)}const Ga=(Ya=({},e,t,s)=>e[t]===s,Wa((e,t)=>Ya(t,...e)));var Ya,Ka,qa;class Xa extends Na{}_i({id:"fTWuUzbA",block:'{"symbols":["@item","@nextPage","@prevPage","@goToPage"],"statements":[[1,1,0,0,"\\n"],[5,[27,[26,2,"BlockHead"],[]],[[31,12,2,[27,[26,1,"CallHead"],[]],[[27,[24,1],[]],"type","page"],null]],null,[["default","else"],[{"statements":[[1,1,0,0,"      "],[9,"button",false],[14,"aria-label",[32,["page number ",[27,[24,1],["page"]]]],null],[14,"class",[32,["mr-2 hover:bg-gray-200 rounded-full p-2 ",[31,141,2,[27,[26,2,"CallHead"],[]],[[27,[24,1],["selected"]],"bg-blue-spirit"],null]]],null],[3,0,0,[27,[26,0,"ModifierHead"],[]],["click",[31,193,2,[27,[26,3,"CallHead"],[]],[[27,[24,4],[]],[27,[24,1],["page"]]],null]],null],[10],[1,1,0,0,"\\n        "],[1,0,0,0,[27,[24,1],["page"]]],[1,1,0,0,"\\n      "],[11],[1,1,0,0,"\\n"]],"parameters":[]},{"statements":[[5,[27,[26,2,"BlockHead"],[]],[[31,275,2,[27,[26,1,"CallHead"],[]],[[27,[24,1],[]],"type","start-ellipsis"],null]],null,[["default","else"],[{"statements":[[1,1,0,0,"      "],[9,"div",true],[12,"aria-label","start ellipsis",null],[12,"class","mr-2",null],[10],[1,1,0,0,"..."],[11],[1,1,0,0,"\\n"]],"parameters":[]},{"statements":[[5,[27,[26,2,"BlockHead"],[]],[[31,388,2,[27,[26,1,"CallHead"],[]],[[27,[24,1],[]],"type","end-ellipsis"],null]],null,[["default","else"],[{"statements":[[1,1,0,0,"      "],[9,"div",true],[12,"aria-label","end ellipsis",null],[12,"class","mr-2",null],[10],[1,1,0,0,"..."],[11],[1,1,0,0,"\\n"]],"parameters":[]},{"statements":[[5,[27,[26,2,"BlockHead"],[]],[[31,497,2,[27,[26,1,"CallHead"],[]],[[27,[24,1],[]],"type","previous"],null]],null,[["default","else"],[{"statements":[[1,1,0,0,"      "],[9,"button",false],[23,"aria-label","previous page",null],[23,"class","border rounded-full mr-4 p-2 shadow hover:bg-gray-200 disabled:opacity-50 disabled:cursor-not-allowed",null],[14,"disabled",[27,[24,1],["disabled"]],null],[3,0,0,[27,[26,0,"ModifierHead"],[]],["click",[27,[24,3],[]]],null],[10],[1,1,0,0,"\\n        "],[9,"svg",true],[12,"class","h-4 w-4 text-gray-500",null],[12,"xmlns","http://www.w3.org/2000/svg","http://www.w3.org/2000/xmlns/"],[12,"fill","none",null],[12,"viewBox","0 0 24 24",null],[12,"stroke","currentColor",null],[10],[1,1,0,0,"\\n          "],[9,"path",true],[12,"stroke-linecap","round",null],[12,"stroke-linejoin","round",null],[12,"stroke-width","2",null],[12,"d","M15 19l-7-7 7-7",null],[10],[11],[1,1,0,0,"\\n        "],[11],[1,1,0,0,"\\n      "],[11],[1,1,0,0,"\\n"]],"parameters":[]},{"statements":[[5,[27,[26,2,"BlockHead"],[]],[[31,1053,2,[27,[26,1,"CallHead"],[]],[[27,[24,1],[]],"type","next"],null]],null,[["default"],[{"statements":[[1,1,0,0,"      "],[9,"button",false],[23,"aria-label","next page",null],[23,"class","border rounded-full ml-2 p-2 shadow hover:bg-gray-200 disabled:opacity-50 disabled:cursor-not-allowed",null],[14,"disabled",[27,[24,1],["disabled"]],null],[3,0,0,[27,[26,0,"ModifierHead"],[]],["click",[27,[24,2],[]]],null],[10],[1,1,0,0,"\\n        "],[9,"svg",true],[12,"class","h-4 w-4 text-gray-500",null],[12,"xmlns","http://www.w3.org/2000/svg","http://www.w3.org/2000/xmlns/"],[12,"fill","none",null],[12,"viewBox","0 0 24 24",null],[12,"stroke","currentColor",null],[10],[1,1,0,0,"\\n          "],[9,"path",true],[12,"stroke-linecap","round",null],[12,"stroke-linejoin","round",null],[12,"stroke-width","2",null],[12,"d","M9 5l7 7-7 7",null],[10],[11],[1,1,0,0,"\\n        "],[11],[1,1,0,0,"\\n      "],[11],[1,1,0,0,"\\n    "]],"parameters":[]}]]]],"parameters":[]}]]]],"parameters":[]}]]]],"parameters":[]}]]]],"parameters":[]}]]],[1,1,0,0,"  "]],"hasEval":false,"upvars":["on","is","if","fn"]}',meta:{scope:()=>({on:Ta,fn:Ja,is:Ga})}},Xa);let Za=_i({id:"DBRv+rS9",block:'{"symbols":["item","item","@goToPage","@prevPage","@nextPage","@pager"],"statements":[[1,1,0,0,"\\n"],[5,[27,[26,1,"BlockHead"],[]],[[27,[24,0],["compact"]]],null,[["default","else"],[{"statements":[[1,1,0,0,"      "],[9,"div",true],[12,"class","flex flex-col items-center",null],[10],[1,1,0,0,"\\n        "],[9,"div",true],[12,"class","flex items-center",null],[10],[1,1,0,0,"\\n"],[5,[27,[26,0,"BlockHead"],[]],[[27,[24,0],["paginatedItems"]]],null,[["default"],[{"statements":[[1,1,0,0,"            "],[7,"PageItem",[],[["@item","@goToPage","@prevPage","@nextPage"],[[27,[24,2],[]],[27,[24,3],[]],[27,[24,4],[]],[27,[24,5],[]]]],null],[1,1,0,0,"\\n"]],"parameters":[2]}]]],[1,1,0,0,"        "],[11],[1,1,0,0,"\\n        "],[9,"div",true],[12,"class","text-gray-500 text-sm",null],[10],[1,1,0,0,"\\n          "],[1,0,0,0,[27,[24,0],["offset"]]],[1,1,0,0,"  "],[1,0,0,0,[27,[24,0],["lastItemOnPage"]]],[1,1,0,0," of "],[1,0,0,0,[27,[24,6],["total_items"]]],[1,1,0,0,"\\n        "],[11],[1,1,0,0,"\\n      "],[11],[1,1,0,0,"\\n"]],"parameters":[]},{"statements":[[1,1,0,0,"      "],[9,"div",true],[12,"class","flex items-center",null],[10],[1,1,0,0,"\\n        "],[9,"div",true],[12,"class","flex items-center mr-6",null],[10],[1,1,0,0,"\\n"],[5,[27,[26,0,"BlockHead"],[]],[[27,[24,0],["paginatedItems"]]],null,[["default"],[{"statements":[[1,1,0,0,"            "],[7,"PageItem",[],[["@item","@goToPage","@prevPage","@nextPage"],[[27,[24,1],[]],[27,[24,3],[]],[27,[24,4],[]],[27,[24,5],[]]]],null],[1,1,0,0,"\\n"]],"parameters":[1]}]]],[1,1,0,0,"        "],[11],[1,1,0,0,"\\n        "],[9,"div",true],[12,"class","text-gray-500",null],[10],[1,1,0,0,"\\n          "],[1,0,0,0,[27,[24,0],["offset"]]],[1,1,0,0,"  "],[1,0,0,0,[27,[24,0],["lastItemOnPage"]]],[1,1,0,0," of "],[1,0,0,0,[27,[24,6],["total_items"]]],[1,1,0,0,"\\n        "],[11],[1,1,0,0,"\\n      "],[11],[1,1,0,0,"\\n"]],"parameters":[]}]]],[1,1,0,0,"  "]],"hasEval":false,"upvars":["each","if"]}',meta:{scope:()=>({PageItem:Xa})}},(qa=function(e,t,s,n,r){var i={};return Object.keys(n).forEach((function(e){i[e]=n[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=s.slice().reverse().reduce((function(s,n){return n(e,t,s)||s}),i),r&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(r):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}((Ka=class extends Na{constructor(...e){super(...e),function(e,t,s,n){s&&Object.defineProperty(e,t,{enumerable:s.enumerable,configurable:s.configurable,writable:s.writable,value:s.initializer?s.initializer.call(n):void 0})}(this,"compact",qa,this)}get lastItemOnPage(){const e=this.offset+this.args.pager.items_per_page-1;return e>this.args.pager.total_items?this.args.pager.total_items:e}get offset(){return(this.args.pager.current_page-1)*this.args.pager.items_per_page+1}get paginatedItems(){let e=this.args.pager.current_page,t=this.compact?1:3,s=this.compact?1:3,n=this.args.pager.total_pages;const r=(e,t)=>{const s=t-e+1;return Array.from({length:s},(t,s)=>e+s)},i=r(1,Math.min(t,n)),a=r(Math.max(n-t+1,t+1),n),l=Math.max(Math.min(e-s,n-t-2*s-1),t+2),o=Math.min(Math.max(e+s,t+2*s+2),a.length>0?a[0]-2:n-1),u=["previous",...i,...l>t+2?["start-ellipsis"]:t+1<n-t?[t+1]:[],...r(l,o),...o<n-t-1?["end-ellipsis"]:n-t>t?[n-t]:[],...a,"next"],c=t=>{switch(t){case"first":return 1;case"previous":return e-1;case"next":return e+1;case"last":return n;default:return null}};return u.map(t=>"number"==typeof t?{type:"page",page:t,selected:t===e,disabled:!1,"aria-current":t===e?"true":void 0}:{type:t,page:c(t),selected:!1,disabled:-1===t.indexOf("ellipsis")&&("next"===t||"last"===t?e>=n:e<=1)})}}).prototype,"compact",[Ma],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return this.args.compact||!1}}),Ka));class Qa extends Na{}_i({id:"T2i05u8J",block:'{"symbols":["@title","@pager","@goToPage","@prevPage","@nextPage"],"statements":[[1,1,0,0,"\\n    "],[9,"div",true],[12,"class","flex bg-white px-4 py-5 border-b border-gray-200 sm:px-6 justify-between items-center",null],[10],[1,1,0,0,"\\n      "],[9,"h2",true],[12,"class","text-xl font-bold leading-6",null],[10],[1,1,0,0,"\\n        "],[1,0,0,0,[27,[24,1],[]]],[1,1,0,0,"\\n      "],[11],[1,1,0,0,"\\n      "],[7,"PaginationControls",[],[["@compact","@pager","@goToPage","@prevPage","@nextPage"],[true,[27,[24,2],[]],[27,[24,3],[]],[27,[24,4],[]],[27,[24,5],[]]]],null],[1,1,0,0,"\\n    "],[11],[1,1,0,0,"\\n  "]],"hasEval":false,"upvars":[]}',meta:{scope:()=>({PaginationControls:Za})}},Qa);class el extends Na{}var tl,sl;_i({id:"qE8k8VX7",block:'{"symbols":[],"statements":[[1,1,0,0,"\\n    "],[9,"div",true],[12,"class","flex items-center justify-center h-24 w-24 mr-2 sm:mr-20 flex-shrink-0",null],[10],[1,1,0,0,"\\n      "],[9,"svg",true],[12,"class","h-16 w-16 text-gray-200",null],[12,"xmlns","http://www.w3.org/2000/svg","http://www.w3.org/2000/xmlns/"],[12,"fill","none",null],[12,"viewBox","0 0 24 24",null],[12,"stroke","currentColor",null],[10],[1,1,0,0,"\\n        "],[9,"path",true],[12,"stroke-linecap","round",null],[12,"stroke-linejoin","round",null],[12,"stroke-width","2",null],[12,"d","M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z",null],[10],[11],[1,1,0,0,"\\n      "],[11],[1,1,0,0,"\\n    "],[11],[1,1,0,0,"\\n  "]],"hasEval":false,"upvars":[]}',meta:{scope:()=>({})}},el);let nl=_i({id:"oA1wDhbM",block:'{"symbols":["@listItem"],"statements":[[1,1,0,0,"\\n    "],[9,"a",true],[13,"href",[32,["/node/",[27,[24,1],["nid"]]]],null],[12,"class","flex items-center justify-between w-full min-h-12 p-4 border-b border-gray-200 hover:bg-gray-100 cursor-pointer",null],[12,"type","button",null],[10],[1,1,0,0,"\\n      "],[9,"div",true],[12,"class","flex items-center",null],[10],[1,1,0,0,"\\n"],[5,[27,[26,0,"BlockHead"],[]],[[27,[24,0],["imageUrl"]]],null,[["default","else"],[{"statements":[[1,1,0,0,"          "],[9,"img",true],[13,"src",[27,[24,0],["imageUrl"]],null],[12,"alt","collection or item image",null],[12,"class","h-24 w-24 mr-2 sm:mr-20 flex-shrink-0",null],[10],[11],[1,1,0,0,"\\n"]],"parameters":[]},{"statements":[[1,1,0,0,"          "],[7,"MissingAsset",[],[[],[]],null],[1,1,0,0,"\\n"]],"parameters":[]}]]],[1,1,0,0,"        "],[9,"div",true],[12,"class","flex flex-col text-align-left w-3/5",null],[10],[1,1,0,0,"\\n          "],[1,0,0,0,[27,[24,1],["title"]]],[1,1,0,0,"\\n          "],[9,"div",true],[12,"class","text-gray-600 line-clamp-2",null],[10],[1,1,0,0,"\\n            "],[1,0,0,0,[27,[24,1],["field_description"]]],[1,1,0,0,"\\n          "],[11],[1,1,0,0,"\\n        "],[11],[1,1,0,0,"\\n      "],[11],[1,1,0,0,"\\n      "],[9,"div",true],[10],[1,1,0,0,"\\n        "],[9,"svg",true],[12,"class","h-6 w-6 text-gray-500",null],[12,"xmlns","http://www.w3.org/2000/svg","http://www.w3.org/2000/xmlns/"],[12,"fill","none",null],[12,"viewBox","0 0 24 24",null],[12,"stroke","currentColor",null],[10],[1,1,0,0,"\\n          "],[9,"path",true],[12,"stroke-linecap","round",null],[12,"stroke-linejoin","round",null],[12,"stroke-width","2",null],[12,"d","M9 5l7 7-7 7",null],[10],[11],[1,1,0,0,"\\n        "],[11],[1,1,0,0,"\\n      "],[11],[1,1,0,0,"\\n    "],[11],[1,1,0,0,"\\n  "]],"hasEval":false,"upvars":["if"]}',meta:{scope:()=>({MissingAsset:el})}},(sl=function(e,t,s,n,r){var i={};return Object.keys(n).forEach((function(e){i[e]=n[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=s.slice().reverse().reduce((function(s,n){return n(e,t,s)||s}),i),r&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(r):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}((tl=class extends Na{constructor(e,t){super(...arguments),function(e,t,s,n){s&&Object.defineProperty(e,t,{enumerable:s.enumerable,configurable:s.configurable,writable:s.writable,value:s.initializer?s.initializer.call(n):void 0})}(this,"imageUrl",sl,this),this.fetchThumbnail()}async fetchThumbnail(){let e=`/jsonapi/media/image?include=thumbnail&filter[media-filter][condition][value]=${this.args.listItem.uuid}&filter[media-filter][condition][operator]=IN&filter[media-filter][condition][path]=field_media_of.id&filter[thumb-filter][condition][value]=Thumbnail Image&filter[thumb-filter][condition][operator]=IN&filter[thumb-filter][condition][path]=field_media_use.name`;try{let t=await fetch(e),s=await t.json();s.data.length>0&&(this.imageUrl=s.included[0].attributes.uri.url)}catch(e){console.log(e)}}}).prototype,"imageUrl",[Ma],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),tl));class rl extends Na{}_i({id:"UFCAov7T",block:'{"symbols":["listItem","@list"],"statements":[[1,1,0,0,"\\n    "],[9,"div",true],[12,"class","bg-white",null],[10],[1,1,0,0,"\\n      "],[9,"div",true],[12,"class","h-auto",null],[10],[1,1,0,0,"\\n"],[5,[27,[26,0,"BlockHead"],[]],[[27,[24,2],[]]],null,[["default"],[{"statements":[[1,1,0,0,"          "],[7,"ListItem",[],[["@listItem"],[[27,[24,1],[]]]],null],[1,1,0,0,"\\n"]],"parameters":[1]}]]],[1,1,0,0,"      "],[11],[1,1,0,0,"\\n    "],[11],[1,1,0,0,"\\n  "]],"hasEval":false,"upvars":["each"]}',meta:{scope:()=>({ListItem:nl})}},rl);class il extends Na{}_i({id:"S+rNk3Cq",block:'{"symbols":[],"statements":[[1,1,0,0,"\\n    "],[9,"div",true],[12,"class","bg-white shadow",null],[10],[1,1,0,0,"\\n      "],[9,"div",true],[12,"class","flex h-auto p-4 items-center justify-center",null],[10],[1,1,0,0,"\\n        "],[9,"div",true],[12,"class","sk-pulse bg-blue-heritage",null],[10],[11],[1,1,0,0,"\\n      "],[11],[1,1,0,0,"\\n    "],[11],[1,1,0,0,"\\n  "]],"hasEval":false,"upvars":[]}',meta:{scope:()=>({})}},il);var al,ll,ol,ul,cl,hl,pl;s(0);function dl(e){return()=>({enumerable:!0,configurable:!1,get(){return(t=this,Ti.get(t)).lookup({type:"service",name:e});var t}})}function ml(e,t,s,n){s&&Object.defineProperty(e,t,{enumerable:s.enumerable,configurable:s.configurable,writable:s.writable,value:s.initializer?s.initializer.call(n):void 0})}function fl(e,t,s,n,r){var i={};return Object.keys(n).forEach((function(e){i[e]=n[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=s.slice().reverse().reduce((function(s,n){return n(e,t,s)||s}),i),r&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(r):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}let gl=_i({id:"Yfk/AeBA",block:'{"symbols":[],"statements":[[1,1,0,0,"\\n    "],[9,"div",true],[12,"class","grid sm:gap-4 grid-cols-1 sm:grid-cols-3 container mx-auto",null],[10],[1,1,0,0,"\\n      "],[7,"FacetList",[[23,"class","col-span-1",null]],[["@facets","@hasFacets","@facetSelected"],[[27,[24,0],["facets"]],[27,[24,0],["hasFacets"]],[27,[24,0],["facetSelected"]]]],null],[1,1,0,0,"\\n      "],[9,"div",true],[12,"class","col-span-2",null],[10],[1,1,0,0,"\\n        "],[9,"div",true],[12,"class","bg-white shadow mb-4",null],[10],[1,1,0,0,"\\n          "],[7,"TitleBar",[],[["@title","@pager","@goToPage","@prevPage","@nextPage"],[[27,[24,0],["title"]],[27,[24,0],["results","pager"]],[27,[24,0],["goToPage"]],[27,[24,0],["prevPage"]],[27,[24,0],["nextPage"]]]],null],[1,1,0,0,"\\n"],[5,[27,[26,0,"BlockHead"],[]],[[27,[24,0],["isLoading"]]],null,[["default","else"],[{"statements":[[1,1,0,0,"            "],[7,"ListSpinner",[],[[],[]],null],[1,1,0,0,"\\n"]],"parameters":[]},{"statements":[[1,1,0,0,"            "],[7,"List",[],[["@list"],[[27,[24,0],["list"]]]],null],[1,1,0,0,"\\n"]],"parameters":[]}]]],[1,1,0,0,"        "],[11],[1,1,0,0,"\\n        "],[9,"div",true],[12,"class","flex bg-white shadow p-4 items-center justify-center",null],[10],[1,1,0,0,"\\n          "],[7,"PaginationControls",[],[["@pager","@goToPage","@prevPage","@nextPage"],[[27,[24,0],["results","pager"]],[27,[24,0],["goToPage"]],[27,[24,0],["prevPage"]],[27,[24,0],["nextPage"]]]],null],[1,1,0,0,"\\n        "],[11],[1,1,0,0,"\\n      "],[11],[1,1,0,0,"\\n    "],[11],[1,1,0,0,"\\n  "]],"hasEval":false,"upvars":["if"]}',meta:{scope:()=>({FacetList:Fa,TitleBar:Qa,List:rl,ListSpinner:il,PaginationControls:Za})}},(ll=fl((al=class extends Na{constructor(e,t){super(...arguments),ml(this,"results",ll,this),ml(this,"title",ol,this),ml(this,"isLoading",ul,this),ml(this,"list",cl,this),ml(this,"facets",hl,this),ml(this,"hasFacets",pl,this),this.fetchCollections(0)}async fetchCollections(e){this.isLoading=!0,await this.results.fetchData(e),this.list=this.results.rows,this.isLoading=!1,await this.results.fetchFacets(),this.facets=this.results.facets,this.hasFacets=this.results.facets.length>0}goToPage(e){this.results.pager.current_page=e,this.fetchCollections(e)}prevPage(){this.results.pager.current_page=--this.results.pager.current_page,this.fetchCollections(this.results.pager.current_page)}nextPage(){this.results.pager.current_page=++this.results.pager.current_page,this.fetchCollections(this.results.pager.current_page)}facetSelected(e){}}).prototype,"results",[function(e,t){return"string"==typeof e?dl(e):dl(t)(e,t)}],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ol=fl(al.prototype,"title",[Ma],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"All Collections"}}),ul=fl(al.prototype,"isLoading",[Ma],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),cl=fl(al.prototype,"list",[Ma],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),hl=fl(al.prototype,"facets",[Ma],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),pl=fl(al.prototype,"hasFacets",[Ma],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),fl(al.prototype,"goToPage",[Pa],Object.getOwnPropertyDescriptor(al.prototype,"goToPage"),al.prototype),fl(al.prototype,"prevPage",[Pa],Object.getOwnPropertyDescriptor(al.prototype,"prevPage"),al.prototype),fl(al.prototype,"nextPage",[Pa],Object.getOwnPropertyDescriptor(al.prototype,"nextPage"),al.prototype),fl(al.prototype,"facetSelected",[Pa],Object.getOwnPropertyDescriptor(al.prototype,"facetSelected"),al.prototype),al));function bl(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class yl{constructor(e){bl(this,"key",void 0),bl(this,"items",void 0),bl(this,"isEmpty",void 0),bl(this,"empty",void 0),this.parseFacet(e)}parseFacet(e){const t=Object.keys(e);if(0===t.length)throw new Error("No facet field found. "+e);if(e.hasOwnProperty("#attributes")&&e["#attributes"].class.includes("facet-empty"))return void this.parseEmptyFacet(e);const s=t[0];this.isEmpty=!1,this.key=s,this.items=e[s].map(e=>({key:s,value:e.values.value,count:e.values.count,url:e.url})),this.items.forEach(e=>e.key=s)}parseEmptyFacet(e){this.isEmpty=!0,this.empty=e,this.key=e["#attributes"]["data-drupal-facet-id"]}item(e){return this.items[e]}length(){return this.items.length}}var vl,wl,kl;function xl(e,t,s,n){s&&Object.defineProperty(e,t,{enumerable:s.enumerable,configurable:s.configurable,writable:s.writable,value:s.initializer?s.initializer.call(n):void 0})}function Sl(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}function El(e,t,s,n,r){var i={};return Object.keys(n).forEach((function(e){i[e]=n[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=s.slice().reverse().reduce((function(s,n){return n(e,t,s)||s}),i),r&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(r):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}const Cl={collections:{types:["collection_object"]},items:{types:["islandora_object"]},mixed:{types:["collection_object","islandora_object"]}};let Al=(wl=El((vl=class{constructor(e){Sl(this,"types",[]),xl(this,"rows",wl,this),xl(this,"pager",kl,this),Sl(this,"facets",void 0),this.types=Cl[e].types}searchParams(e){let t="";const s="page="+--e;return t=`${""+this.types.map(e=>"ss_type:"+e).join(" OR ")}${e?"&"+s:""}`,console.log("SearchParams: "+t),"*:*"}async fetchData(e){const t="&page="+--e;let s="/search_rest_endpoint?query="+this.types.map(e=>"ss_type:"+e).join(" OR ");e&&(s+=t);try{let e=await fetch(s),t=await e.json();this.rows=t.rows,this.pager=t.pager,this.pager.current_page=++this.pager.current_page}catch(e){console.log(e)}}async fetchFacets(){const e="/search_facet_endpoint?query="+this.searchParams();try{let t=await fetch(e),s=await t.json();this.facets=this.parseFacets(s.facets)}catch(e){console.log(e)}}parseFacets(e){let t=[];return e.forEach(e=>{t.push(new yl(e[0]))}),t.filter(e=>!e.isEmpty)}}).prototype,"rows",[Ma],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),kl=El(vl.prototype,"pager",[Ma],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{current_page:0,total_items:0,total_pages:0,items_per_page:0}}}),vl);const Nl=document.getElementById("collections-list");Nl&&function(e,t){if(t instanceof Element)return ya(e,t);const{element:s,args:n,services:i}=t,a=new r(null!=i?i:{});ya(e,{element:s,args:n,owner:a})}(gl,{element:Nl,services:{results:new Al("collections")}})}]);